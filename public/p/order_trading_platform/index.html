<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="åŸºäºDjangoå¼€å‘çš„å‰åç«¯ä¸åˆ†ç¦»çš„è®¢å•äº¤æ˜“å¹³å°">
<title>é¡¹ç›®ï¼šè®¢å•äº¤æ˜“å¹³å°</title>

<link rel='canonical' href='https://yn0t1me.github.io/p/order_trading_platform/'>

<link rel="stylesheet" href="/scss/style.min.b9c8156d464c343bdacaf14a871581fb94cbbdb9dd5cbce4ba017361187cc930.css"><meta property='og:title' content="é¡¹ç›®ï¼šè®¢å•äº¤æ˜“å¹³å°">
<meta property='og:description' content="åŸºäºDjangoå¼€å‘çš„å‰åç«¯ä¸åˆ†ç¦»çš„è®¢å•äº¤æ˜“å¹³å°">
<meta property='og:url' content='https://yn0t1me.github.io/p/order_trading_platform/'>
<meta property='og:site_name' content='yn0t1meçš„åšå®¢'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='Django' /><meta property='article:tag' content='python' /><meta property='article:published_time' content='2025-02-27T18:57:50&#43;08:00'/><meta property='article:modified_time' content='2025-02-27T18:57:50&#43;08:00'/>
<meta name="twitter:title" content="é¡¹ç›®ï¼šè®¢å•äº¤æ˜“å¹³å°">
<meta name="twitter:description" content="åŸºäºDjangoå¼€å‘çš„å‰åç«¯ä¸åˆ†ç¦»çš„è®¢å•äº¤æ˜“å¹³å°">
    <link rel="shortcut icon" href="/favicon.ico" />

    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="åˆ‡æ¢èœå•">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu_901763171188d896.png" width="300"
                            height="284" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">ğŸ§</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">yn0t1meçš„åšå®¢</a></h1>
            <h2 class="site-description">äººç”ŸèŒ«èŒ«ï¼Œå”¯æ­»äº¡ä¸çˆ±è€Œå·²</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://github.com/yn0t1me'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://twitter.com'
                        target="_blank"
                        title="Twitter"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c-.002 -.249 1.51 -2.772 1.818 -4.013z" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>ä¸»é¡µ</span>
            </a>
        </li>
        
        
        <li >
            <a href='/about/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>å…³äº</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>å½’æ¡£</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>æœç´¢</span>
            </a>
        </li>
        
        
        <li >
            <a href='/links/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>å‹é“¾</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">

                
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>æš—è‰²æ¨¡å¼</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">ç›®å½•</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#å•ç‚¹çŸ¥è¯†">å•ç‚¹çŸ¥è¯†</a>
      <ol>
        <li><a href="#å‘é€çŸ­ä¿¡">å‘é€çŸ­ä¿¡</a></li>
        <li><a href="#æƒé™å’Œèœå•ç®¡ç†">æƒé™å’Œèœå•ç®¡ç†</a>
          <ol>
            <li><a href="#èœå•">èœå•</a></li>
            <li><a href="#æƒé™">æƒé™</a></li>
            <li><a href="#å®ç°çš„å‰ç½®å°çŸ¥è¯†">å®ç°çš„å‰ç½®å°çŸ¥è¯†</a></li>
          </ol>
        </li>
        <li><a href="#ajaxè¯·æ±‚">ajaxè¯·æ±‚</a></li>
        <li><a href="#csrftoken">csrftoken</a>
          <ol>
            <li><a href="#formè¡¨å•">formè¡¨å•</a></li>
            <li><a href="#ajaxæ–¹å¼">ajaxæ–¹å¼</a></li>
            <li><a href="#å‘åç«¯å‘é€è¯·æ±‚">å‘åç«¯å‘é€è¯·æ±‚</a></li>
            <li><a href="#csrfè®¤è¯">csrfè®¤è¯</a></li>
            <li><a href="#djangoçš„è‡ªå®šä¹‰è¯·æ±‚å¤´">djangoçš„è‡ªå®šä¹‰è¯·æ±‚å¤´</a></li>
          </ol>
        </li>
        <li><a href="#formç»„ä»¶">formç»„ä»¶</a>
          <ol>
            <li><a href="#è‡ªå®šä¹‰è¡¨å•ç±»">è‡ªå®šä¹‰è¡¨å•ç±»</a></li>
            <li><a href="#è‡ªå®šä¹‰é”™è¯¯å­—æ®µä¿¡æ¯">è‡ªå®šä¹‰é”™è¯¯å­—æ®µä¿¡æ¯</a></li>
            <li><a href="#è‡ªå®šä¹‰è¡¨å•è¾“å…¥widget">è‡ªå®šä¹‰è¡¨å•è¾“å…¥<code>widget</code></a></li>
            <li><a href="#è¡¨å•çš„å®ä¾‹åŒ–ä¸åˆå§‹åŒ–">è¡¨å•çš„å®ä¾‹åŒ–ä¸åˆå§‹åŒ–</a></li>
            <li><a href="#è¡¨å•çš„ä½¿ç”¨">è¡¨å•çš„ä½¿ç”¨</a></li>
            <li><a href="#ç»§æ‰¿formç±»">ç»§æ‰¿Formç±»</a></li>
            <li><a href="#ç»§æ‰¿modelformç±»">ç»§æ‰¿ModelFormç±»</a></li>
            <li><a href="#formçš„æ ¡éªŒæµç¨‹">formçš„æ ¡éªŒæµç¨‹</a></li>
            <li><a href="#formæ ·å¼è®¾ç½®">formæ ·å¼è®¾ç½®</a></li>
            <li><a href="#formç»„ä»¶åŸºæœ¬æ“ä½œ">formç»„ä»¶åŸºæœ¬æ“ä½œ</a></li>
          </ol>
        </li>
        <li><a href="#model">Model</a>
          <ol>
            <li><a href="#ä¿®æ”¹æŸ¥è¯¢æ¡ä»¶">ä¿®æ”¹æŸ¥è¯¢æ¡ä»¶</a></li>
          </ol>
        </li>
        <li><a href="#æ¨¡æ¿">æ¨¡æ¿</a>
          <ol>
            <li><a href="#æ¯ç‰ˆ">æ¯ç‰ˆ</a></li>
            <li><a href="#inclusion_tag">inclusion_tag</a></li>
          </ol>
        </li>
        <li><a href="#é˜Ÿåˆ—">é˜Ÿåˆ—</a></li>
        <li><a href="#workerå’Œçº¿æ€§æ± ">workerå’Œçº¿æ€§æ± </a></li>
        <li><a href="#åˆ†é¡µç»„ä»¶">åˆ†é¡µç»„ä»¶</a>
          <ol>
            <li><a href="#é€‰é¡¹ç”Ÿæˆ">é€‰é¡¹ç”Ÿæˆ</a></li>
            <li><a href="#é¡µç é€»è¾‘å’ŒåŠ¨æ€é¡µç ">é¡µç é€»è¾‘å’ŒåŠ¨æ€é¡µç </a></li>
            <li><a href="#åˆ†é¡µç»„ä»¶çš„å°è£…">åˆ†é¡µç»„ä»¶çš„å°è£…</a></li>
            <li><a href="#ä¼˜åŒ–">ä¼˜åŒ–</a></li>
            <li><a href="#querydict">querydict</a></li>
            <li><a href="#è§£å†³urlå‚æ•°æºå¸¦é—®é¢˜">è§£å†³urlå‚æ•°æºå¸¦é—®é¢˜</a></li>
            <li><a href="#æœ€ç»ˆç‰ˆ">æœ€ç»ˆç‰ˆ</a></li>
          </ol>
        </li>
        <li><a href="#æœç´¢ç»„ä»¶">æœç´¢ç»„ä»¶</a>
          <ol>
            <li><a href="#qå¯¹è±¡">Qå¯¹è±¡</a></li>
            <li><a href="#æ™®é€šæœç´¢">æ™®é€šæœç´¢</a></li>
            <li><a href="#ç»„åˆæœç´¢">ç»„åˆæœç´¢</a></li>
          </ol>
        </li>
        <li><a href="#æƒé™æŒ‰é’®">æƒé™æŒ‰é’®</a>
          <ol>
            <li><a href="#åœ¨æ¨¡æ¿ä¸­è‡ªå®šä¹‰æ–¹æ³•">åœ¨æ¨¡æ¿ä¸­è‡ªå®šä¹‰æ–¹æ³•</a></li>
            <li><a href="#åå‘ç”Ÿæˆurl">åå‘ç”ŸæˆURL</a></li>
            <li><a href="#å®ç°">å®ç°</a></li>
          </ol>
        </li>
        <li><a href="#è·³è½¬é“¾æ¥">è·³è½¬é“¾æ¥</a></li>
        <li><a href="#äº‹åŠ¡">äº‹åŠ¡</a>
          <ol>
            <li><a href="#ä»‹ç»">ä»‹ç»</a></li>
            <li><a href="#mysqlå®¢æˆ·ç«¯">MySQLå®¢æˆ·ç«¯</a></li>
            <li><a href="#pythonä»£ç ">Pythonä»£ç </a></li>
            <li><a href="#djangoæ“ä½œ">Djangoæ“ä½œ</a></li>
          </ol>
        </li>
        <li><a href="#é”">é”</a>
          <ol>
            <li><a href="#ä»‹ç»-1">ä»‹ç»</a></li>
          </ol>
        </li>
        <li><a href="#messageç»„ä»¶">Messageç»„ä»¶</a>
          <ol>
            <li><a href="#é…ç½®">é…ç½®</a></li>
            <li><a href="#è¯»å–å€¼">è¯»å–å€¼</a></li>
            <li><a href="#æºç åˆ†æ">æºç åˆ†æ</a></li>
          </ol>
        </li>
        <li><a href="#ç»„åˆæœç´¢-1">ç»„åˆæœç´¢</a>
          <ol>
            <li><a href="#ä½¿ç”¨">ä½¿ç”¨</a></li>
          </ol>
        </li>
        <li><a href="#æ‚">æ‚</a>
          <ol>
            <li><a href="#åœ¨å…¨å±€å˜é‡ä¸­å®šä¹‰è‡ªå·±çš„ä¸“å±é…ç½®">åœ¨å…¨å±€å˜é‡ä¸­å®šä¹‰è‡ªå·±çš„ä¸“å±é…ç½®</a></li>
            <li><a href="#é¢å‘å¯¹è±¡å°çŸ¥è¯†">é¢å‘å¯¹è±¡å°çŸ¥è¯†</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#é¡¹ç›®">é¡¹ç›®</a>
      <ol>
        <li><a href="#ç”¨æˆ·è®¤è¯ç›¸å…³">ç”¨æˆ·è®¤è¯ç›¸å…³</a>
          <ol>
            <li><a href="#ç”¨æˆ·åå¯†ç ç™»å½•">ç”¨æˆ·åå¯†ç ç™»å½•</a></li>
            <li><a href="#æ‰‹æœºéªŒè¯ç ç™»å½•">æ‰‹æœºéªŒè¯ç ç™»å½•</a></li>
          </ol>
        </li>
        <li><a href="#èœå•å’Œæƒé™">èœå•å’Œæƒé™</a>
          <ol>
            <li><a href="#è®¿é—®æƒé™">è®¿é—®æƒé™</a></li>
            <li><a href="#æŒ‰é’®æ˜¾ç¤ºæƒé™">æŒ‰é’®æ˜¾ç¤ºæƒé™</a></li>
          </ol>
        </li>
        <li><a href="#çº§åˆ«ç®¡ç†">çº§åˆ«ç®¡ç†</a>
          <ol>
            <li><a href="#çº§åˆ«åˆ—è¡¨">çº§åˆ«åˆ—è¡¨</a></li>
            <li><a href="#æ–°å¢çº§åˆ«">æ–°å¢çº§åˆ«</a></li>
            <li><a href="#ç¼–è¾‘çº§åˆ«">ç¼–è¾‘çº§åˆ«</a></li>
            <li><a href="#åˆ é™¤çº§åˆ«">åˆ é™¤çº§åˆ«</a></li>
          </ol>
        </li>
        <li><a href="#å®¢æˆ·ç®¡ç†">å®¢æˆ·ç®¡ç†</a>
          <ol>
            <li><a href="#å®¢æˆ·åˆ—è¡¨">å®¢æˆ·åˆ—è¡¨</a></li>
            <li><a href="#æ–°å»ºå®¢æˆ·">æ–°å»ºå®¢æˆ·</a></li>
            <li><a href="#ç¼–è¾‘å®¢æˆ·">ç¼–è¾‘å®¢æˆ·</a></li>
            <li><a href="#é‡ç½®å¯†ç ">é‡ç½®å¯†ç </a></li>
            <li><a href="#åˆ é™¤å®¢æˆ·å¯¹è¯æ¡†å’Œajax">åˆ é™¤å®¢æˆ·ï¼ˆå¯¹è¯æ¡†å’Œajaxï¼‰</a></li>
            <li><a href="#äº¤æ˜“è®°å½•åˆ—è¡¨">äº¤æ˜“è®°å½•åˆ—è¡¨</a></li>
            <li><a href="#å……å€¼å’Œæ‰£æ¬¾å¯¹è¯æ¡†">å……å€¼å’Œæ‰£æ¬¾ï¼ˆå¯¹è¯æ¡†ï¼‰</a></li>
            <li><a href="#"><img src="/post/python/order_trading_platform/1732714253476-a85ee918-3e85-4bc0-9420-fb090b70999e.png" alt=""></a></li>
          </ol>
        </li>
        <li><a href="#ä»·æ ¼ç­–ç•¥">ä»·æ ¼ç­–ç•¥</a>
          <ol>
            <li><a href="#ä»·æ ¼ç­–ç•¥åˆ—è¡¨">ä»·æ ¼ç­–ç•¥åˆ—è¡¨</a></li>
            <li><a href="#æ–°å»ºä»·æ ¼ç­–ç•¥">æ–°å»ºä»·æ ¼ç­–ç•¥</a></li>
            <li><a href="#ç¼–è¾‘ä»·æ ¼ç­–ç•¥">ç¼–è¾‘ä»·æ ¼ç­–ç•¥</a></li>
            <li><a href="#åˆ é™¤ä»·æ ¼ç­–ç•¥">åˆ é™¤ä»·æ ¼ç­–ç•¥</a></li>
          </ol>
        </li>
        <li><a href="#è®¢å•ç®¡ç†ç”¨æˆ·">è®¢å•ç®¡ç†ï¼ˆç”¨æˆ·ï¼‰</a>
          <ol>
            <li><a href="#æˆ‘çš„è®¢å•åˆ—è¡¨">æˆ‘çš„è®¢å•åˆ—è¡¨</a></li>
            <li><a href="#æ–°å»ºè®¢å•">æ–°å»ºè®¢å•</a></li>
            <li><a href="#æ’¤é”€è®¢å•">æ’¤é”€è®¢å•</a></li>
          </ol>
        </li>
        <li><a href="#æˆ‘çš„äº¤æ˜“è®°å½•">æˆ‘çš„äº¤æ˜“è®°å½•</a>
          <ol>
            <li><a href="#å®¢æˆ·">å®¢æˆ·</a></li>
            <li><a href="#ç®¡ç†å‘˜">ç®¡ç†å‘˜</a></li>
          </ol>
        </li>
        <li><a href="#worker">Worker</a></li>
      </ol>
    </li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/python/" style="background-color: #2a9d8f; color: #fff;">
                Python
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/order_trading_platform/">é¡¹ç›®ï¼šè®¢å•äº¤æ˜“å¹³å°</a>
        </h2>
    
        
        <h3 class="article-subtitle">
            åŸºäºDjangoå¼€å‘çš„å‰åç«¯ä¸åˆ†ç¦»çš„è®¢å•äº¤æ˜“å¹³å°
        </h3>
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Feb 27, 2025</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    é˜…è¯»æ—¶é•¿: 28 åˆ†é’Ÿ
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <p>å½“æ—¶è·Ÿç€å­¦çš„æ—¶å€™è¿˜æ²¡å…»æˆåšç¬”è®°çš„ä¹ æƒ¯ï¼Œå› æ­¤è¯¥æ–‡æ˜¯äº‹åå¤ä¹ æ—¶å†™çš„ï¼Œå†…å®¹æœ‰äº›å‡Œä¹±ï¼Œè§è°…</p>
<p>æ ¸å¿ƒçš„åŠŸèƒ½æ¨¡å—</p>
<ul>
<li>è®¤è¯æ¨¡å—ï¼Œç”¨æˆ·åå¯†ç ç™»å½•æˆ–æ”¶é›†çŸ­ä¿¡ç™»å½•ï¼ˆ60sæœ‰æ•ˆï¼‰</li>
<li>è§’è‰²ç®¡ç†ï¼Œä¸åŒè§’è‰²æœ‰ä¸åŒæƒé™å’Œå±•ç¤ºä¸åŒèœå•</li>
<li>å®¢æˆ·ç®¡ç†ï¼Œå¯¹å®¢æˆ·åˆ†çº§ï¼Œå®¢æˆ·çš„å¢åˆ æ”¹æŸ¥æ“ä½œ</li>
<li>äº¤æ˜“ä¸­å¿ƒ
<ul>
<li>ç®¡ç†å‘˜ç»™å®¢æˆ·å……å€¼æ‰£è´¹</li>
<li>å®¢æˆ·å¯ä»¥ä¸‹å•æ’¤å•</li>
<li>ç”Ÿæˆäº¤æ˜“è®°å½•</li>
<li>å¯¹è®¢å•è¿›è¡Œå¤šç»´åº¦æœç´¢</li>
</ul>
</li>
<li>wordkerï¼Œæ‰§è¡Œè®¢å•å¹¶æ›´æ–°è®¢å•çŠ¶æ€</li>
</ul>
<h2 id="å•ç‚¹çŸ¥è¯†">å•ç‚¹çŸ¥è¯†
</h2><h3 id="å‘é€çŸ­ä¿¡">å‘é€çŸ­ä¿¡
</h3><p>é˜¿é‡Œäº‘çŸ­ä¿¡æœåŠ¡æ¥è¿›è¡Œå‘é€çŸ­ä¿¡</p>
<ul>
<li>æ³¨å†Œè´¦å·</li>
<li>å¼€é€šæœåŠ¡ + ç¼´è´¹</li>
<li>APIæœåŠ¡ã€SDKæœåŠ¡
<ul>
<li>APIæ¥å£</li>
</ul>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å¤„ç†ç­¾åå’ŒåŠ å¯†</span>
</span></span><span class="line"><span class="cl"><span class="n">res</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;......&#34;</span><span class="p">,</span><span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s2">&#34;key&#34;</span><span class="p">:</span><span class="s2">&#34;xxx&#34;</span><span class="p">,</span><span class="s1">&#39;token&#39;</span><span class="p">:</span><span class="s1">&#39;...&#39;</span><span class="p">})</span>
</span></span></code></pre></td></tr></table>
</div>
</div><pre><code>- SDKæœåŠ¡
</code></pre>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">pip</span> <span class="n">install</span> <span class="n">aliyun</span><span class="o">-</span><span class="n">python</span><span class="o">-</span><span class="n">sdk</span><span class="o">-</span><span class="n">core</span>
</span></span><span class="line"><span class="cl"><span class="n">pip</span> <span class="n">install</span> <span class="n">aliyun</span><span class="o">-</span><span class="n">python</span><span class="o">-</span><span class="n">sdk</span><span class="o">-</span><span class="n">dysmsapi</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">xxxx</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">xxxxx</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç¤ºä¾‹</p>
<p>ä»…ä½œå‚è€ƒï¼Œå…·ä½“æ¨èä¾ç…§å®˜æ–¹æ–‡æ¡£è¿›è¡Œé…ç½®</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">aliyunsdkcore.client</span> <span class="kn">import</span> <span class="n">AcsClient</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">aliyunsdkcore.request</span> <span class="kn">import</span> <span class="n">CommonRequest</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">json</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">sendSms</span><span class="p">(</span><span class="n">phone</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># æ›¿æ¢ä¸ºä½ çš„AccessKeyä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">ACCESS_KEY_ID</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="n">ACCESS_KEY_SECRET</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="n">SIGN_NAME</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>  <span class="c1"># ç­¾ååç§°</span>
</span></span><span class="line"><span class="cl">        <span class="n">TEMPLATE_CODE</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>  <span class="c1"># æ¨¡æ¿CODE</span>
</span></span><span class="line"><span class="cl">        <span class="n">PHONE_NUMBER</span> <span class="o">=</span> <span class="n">phone</span>  <span class="c1"># ç»‘å®šçš„æµ‹è¯•æ‰‹æœºå·</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">acs_client</span> <span class="o">=</span> <span class="n">AcsClient</span><span class="p">(</span><span class="n">ACCESS_KEY_ID</span><span class="p">,</span> <span class="n">ACCESS_KEY_SECRET</span><span class="p">,</span> <span class="n">TEMPLATE_CODE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">request</span> <span class="o">=</span> <span class="n">CommonRequest</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">request</span><span class="o">.</span><span class="n">set_accept_format</span><span class="p">(</span><span class="s1">&#39;json&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">request</span><span class="o">.</span><span class="n">set_domain</span><span class="p">(</span><span class="s1">&#39;dysmsapi.aliyuncs.com&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">request</span><span class="o">.</span><span class="n">set_method</span><span class="p">(</span><span class="s1">&#39;POST&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">request</span><span class="o">.</span><span class="n">set_version</span><span class="p">(</span><span class="s1">&#39;2017-05-25&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">request</span><span class="o">.</span><span class="n">set_action_name</span><span class="p">(</span><span class="s1">&#39;SendSms&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1"># è®¾ç½®çŸ­ä¿¡æ¨¡æ¿å‚æ•°</span>
</span></span><span class="line"><span class="cl">        <span class="n">request</span><span class="o">.</span><span class="n">add_query_param</span><span class="p">(</span><span class="s1">&#39;PhoneNumbers&#39;</span><span class="p">,</span> <span class="n">PHONE_NUMBER</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">request</span><span class="o">.</span><span class="n">add_query_param</span><span class="p">(</span><span class="s1">&#39;SignName&#39;</span><span class="p">,</span> <span class="n">SIGN_NAME</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">request</span><span class="o">.</span><span class="n">add_query_param</span><span class="p">(</span><span class="s1">&#39;TemplateCode&#39;</span><span class="p">,</span> <span class="n">TEMPLATE_CODE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">request</span><span class="o">.</span><span class="n">add_query_param</span><span class="p">(</span><span class="s1">&#39;TemplateParam&#39;</span><span class="p">,</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">({</span><span class="s2">&#34;code&#34;</span><span class="p">:</span> <span class="n">message</span><span class="p">}))</span>  <span class="c1"># æ¨¡æ¿ä¸­çš„å˜é‡æ›¿æ¢ä¸ºå®é™…çš„å€¼</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1"># å‘é€çŸ­ä¿¡è¯·æ±‚å¹¶è·å–è¿”å›ç»“æœ</span>
</span></span><span class="line"><span class="cl">        <span class="n">response</span> <span class="o">=</span> <span class="n">acs_client</span><span class="o">.</span><span class="n">do_action_with_exception</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">response_str</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">response_dict</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response_str</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">response_dict</span><span class="p">[</span><span class="s1">&#39;Code&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&#34;OK&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">pass</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="æƒé™å’Œèœå•ç®¡ç†">æƒé™å’Œèœå•ç®¡ç†
</h3><h4 id="èœå•">èœå•
</h4><ul>
<li>é¡µé¢å†™æ­»</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">html</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">è§’è‰²</span> <span class="s2">&#34;ç®¡ç†å‘˜&#34;</span><span class="o">%</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">    	<span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s2">&#34;/xxx/x&#34;</span><span class="o">&gt;</span><span class="n">ç”¨æˆ·ç®¡ç†</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    	<span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s2">&#34;/xxx/x&#34;</span><span class="o">&gt;</span><span class="n">çº§åˆ«ç®¡ç†</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    	<span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s2">&#34;/xxx/x&#34;</span><span class="o">&gt;</span><span class="n">çº§åˆ«ç®¡ç†</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    	<span class="o">...</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span><span class="o">%</span> <span class="k">else</span> <span class="o">%</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">    	<span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s2">&#34;/xxx/x&#34;</span><span class="o">&gt;</span><span class="n">xxxç®¡ç†</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    	<span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s2">&#34;/xxx/x&#34;</span><span class="o">&gt;</span><span class="n">çº§åˆ«ç®¡ç†</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="n">html</span><span class="o">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>èœå•æ”¾åœ¨é…ç½®æ–‡ä»¶</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># settings.py</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ADMIN</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span><span class="s2">&#34;title&#34;</span><span class="p">:</span><span class="s2">&#34;ç”¨æˆ·ç®¡ç†&#34;</span><span class="p">,</span> <span class="s2">&#34;url&#34;</span><span class="p">:</span><span class="s2">&#34;....&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span><span class="s2">&#34;title&#34;</span><span class="p">:</span><span class="s2">&#34;ç”¨æˆ·ç®¡ç†&#34;</span><span class="p">,</span> <span class="s2">&#34;url&#34;</span><span class="p">:</span><span class="s2">&#34;....&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span><span class="s2">&#34;title&#34;</span><span class="p">:</span><span class="s2">&#34;ç”¨æˆ·ç®¡ç†&#34;</span><span class="p">,</span> <span class="s2">&#34;url&#34;</span><span class="p">:</span><span class="s2">&#34;....&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span><span class="s2">&#34;title&#34;</span><span class="p">:</span><span class="s2">&#34;ç”¨æˆ·ç®¡ç†&#34;</span><span class="p">,</span> <span class="s2">&#34;url&#34;</span><span class="p">:</span><span class="s2">&#34;....&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">USER</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span><span class="s2">&#34;title&#34;</span><span class="p">:</span><span class="s2">&#34;ç”¨æˆ·ç®¡ç†&#34;</span><span class="p">,</span> <span class="s2">&#34;url&#34;</span><span class="p">:</span><span class="s2">&#34;....&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span><span class="s2">&#34;title&#34;</span><span class="p">:</span><span class="s2">&#34;ç”¨æˆ·ç®¡ç†&#34;</span><span class="p">,</span> <span class="s2">&#34;url&#34;</span><span class="p">:</span><span class="s2">&#34;....&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span><span class="s2">&#34;title&#34;</span><span class="p">:</span><span class="s2">&#34;ç”¨æˆ·ç®¡ç†&#34;</span><span class="p">,</span> <span class="s2">&#34;url&#34;</span><span class="p">:</span><span class="s2">&#34;....&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span><span class="s2">&#34;title&#34;</span><span class="p">:</span><span class="s2">&#34;ç”¨æˆ·ç®¡ç†&#34;</span><span class="p">,</span> <span class="s2">&#34;url&#34;</span><span class="p">:</span><span class="s2">&#34;....&#34;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">html</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">è§’è‰²</span> <span class="s2">&#34;ç®¡ç†å‘˜&#34;</span><span class="o">%</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">    	<span class="p">{</span><span class="o">%</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">ADMIN</span><span class="o">%</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">		    <span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s2">&#34;{{item.url}}&#34;</span><span class="o">&gt;</span><span class="p">{{</span><span class="n">item</span><span class="o">.</span><span class="n">title</span><span class="p">}}</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	    <span class="p">{</span><span class="o">%</span><span class="n">emdfor</span><span class="o">%</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span><span class="o">%</span> <span class="k">else</span> <span class="o">%</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">    	<span class="p">{</span><span class="o">%</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">USER</span><span class="o">%</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">		    <span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s2">&#34;{{item.url}}&#34;</span><span class="o">&gt;</span><span class="p">{{</span><span class="n">item</span><span class="o">.</span><span class="n">title</span><span class="p">}}</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	    <span class="p">{</span><span class="o">%</span><span class="n">emdfor</span><span class="o">%</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="n">html</span><span class="o">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>å°†èœå• + è§’è‰²å†™å…¥æ•°æ®åº“</li>
</ul>
<p><img src="/post/python/order_trading_platform/1732339379585-36fe528c-6de1-4063-8dd3-410112a3d40c.png"
	
	
	
	loading="lazy"
	
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># åœ¨é¡µé¢å±•ç¤ºæ•°æ®åº“</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 1.æŸ¥è¯¢ç‰¹å®šè§’è‰²å…³è”çš„æ‰€æœ‰çš„èœå•</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 2.åœ¨é¡µé¢ä¸Šè¿›è¡Œå±•ç¤º</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¦‚æœé€‰æ‹©é…ç½®æ–‡ä»¶çš„æ–¹å¼ï¼š</p>
<ul>
<li>èœå•é…ç½®</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">ADMIN</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;title&#34;</span><span class="p">:</span><span class="s2">&#34;ç”¨æˆ·ç®¡ç†&#34;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;children&#34;</span><span class="p">:[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span><span class="s2">&#34;title&#34;</span><span class="p">:</span><span class="s2">&#34;çº§åˆ«åˆ—è¡¨&#34;</span><span class="p">,</span><span class="s2">&#34;url&#34;</span><span class="p">:</span><span class="s2">&#34;....&#34;</span><span class="p">,</span> <span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;level_list&#34;</span><span class="p">,}</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span><span class="s2">&#34;title&#34;</span><span class="p">:</span><span class="s2">&#34;çº§åˆ«åˆ—è¡¨&#34;</span><span class="p">,</span><span class="s2">&#34;url&#34;</span><span class="p">:</span><span class="s2">&#34;....&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span><span class="s2">&#34;title&#34;</span><span class="p">:</span><span class="s2">&#34;çº§åˆ«åˆ—è¡¨&#34;</span><span class="p">,</span><span class="s2">&#34;url&#34;</span><span class="p">:</span><span class="s2">&#34;....&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;title&#34;</span><span class="p">:</span><span class="s2">&#34;è®¢å•ç®¡ç†&#34;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;children&#34;</span><span class="p">:[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span><span class="s2">&#34;title&#34;</span><span class="p">:</span><span class="s2">&#34;è®¢å•åˆ—è¡¨&#34;</span><span class="p">,</span><span class="s2">&#34;url&#34;</span><span class="p">:</span><span class="s2">&#34;....&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span><span class="s2">&#34;title&#34;</span><span class="p">:</span><span class="s2">&#34;è®¢å•åˆ—è¡¨&#34;</span><span class="p">,</span><span class="s2">&#34;url&#34;</span><span class="p">:</span><span class="s2">&#34;....&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span><span class="s2">&#34;title&#34;</span><span class="p">:</span><span class="s2">&#34;è®¢å•åˆ—è¡¨&#34;</span><span class="p">,</span><span class="s2">&#34;url&#34;</span><span class="p">:</span><span class="s2">&#34;....&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>èœå•é€‰ä¸­å’Œå±•å¼€é—®é¢˜</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="mf">1.</span><span class="n">è·å–å½“å‰ç”¨æˆ·è¯·æ±‚çš„</span> <span class="n">URL</span> <span class="n">pricepolicy</span><span class="o">/</span><span class="nb">list</span><span class="o">/</span> <span class="n">æˆ–</span> <span class="n">urlå¯¹åº”çš„name</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">2.</span> <span class="n">pricepolicy</span><span class="o">/</span><span class="nb">list</span><span class="o">/</span> <span class="n">é…ç½®</span> <span class="n">ADMINä¸­çš„URL</span>   <span class="o">-&gt;</span><span class="n">é»˜è®¤é€‰ä¸­</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>è·¯å¾„å¯¼å¯¼èˆªé—®é¢˜</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="mf">1.</span><span class="n">è·å–å½“å‰ç”¨æˆ·è¯·æ±‚çš„</span> <span class="n">URL</span>   <span class="n">pricepolicy</span><span class="o">/</span><span class="nb">list</span><span class="o">/</span> <span class="n">æˆ–</span> <span class="n">urlå¯¹åº”çš„name</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">2.</span><span class="n">è·å–ä¸Šçº§</span><span class="err">ï¼Œ</span><span class="n">å±•ç¤ºå¯¼èˆªä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">3.</span><span class="n">è®¾ç½®èœå•ä¸ä¸‹çº§å…³ç³»</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ‹“å±•ï¼šèœå•å¤šçº§å…³ç³»</p>
<p><img src="/post/python/order_trading_platform/1732339989906-a9856733-c818-43dd-8bac-d93df45a45fa.png"
	
	
	
	loading="lazy"
	
	
></p>
<h4 id="æƒé™">æƒé™
</h4><p>æƒé™çš„åˆ¤å®šï¼Œè¦è€ƒè™‘ï¼šæ­£å¸¸çš„ç‚¹å‡»ã€éæ³•çš„è¾“å…¥</p>
<ul>
<li>æ–‡ä»¶settings.pyçš„æ–¹å¼</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">admin_permisions</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;level_list&#34;</span><span class="p">:{</span><span class="o">...</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;level_edit&#34;</span><span class="p">:{</span><span class="o">...</span><span class="p">,</span> <span class="s1">&#39;parent&#39;</span><span class="p">:</span><span class="s1">&#39;level_list&#39;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;level_add&#34;</span><span class="p">:{</span><span class="o">...</span> <span class="s1">&#39;parent&#39;</span><span class="p">:</span><span class="s1">&#39;level_list&#39;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;level_delete&#34;</span><span class="p">:{</span><span class="o">..</span><span class="s1">&#39;parent&#39;</span><span class="p">:</span><span class="s1">&#39;level_list&#39;</span><span class="o">.</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;user_list&#34;</span><span class="p">:{</span><span class="o">...</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;user_edit&#34;</span><span class="p">:{</span><span class="o">...</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;user_add&#34;</span><span class="p">:{</span><span class="o">...</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;user_delete&#34;</span><span class="p">:{</span><span class="o">...</span><span class="p">},</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">user_permisions</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">adminè®¿é—®æŸä¸ªURL</span> <span class="o">+</span> <span class="n">è·¯ç”±ä¿¡æ¯</span><span class="err">ï¼ˆ</span><span class="n">name</span><span class="err">ï¼Œ</span><span class="n">namespace</span><span class="err">ï¼‰ï¼Œ</span><span class="n">è·å–å½“å‰URL</span> <span class="o">/</span><span class="n">level</span><span class="o">/</span><span class="n">dedit</span><span class="o">/</span><span class="mi">4</span><span class="o">/</span> <span class="o">-&gt;</span> <span class="n">æ˜¯å¦å­˜åœ¨URL</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">åœ¨ä¸­é—´ä»¶ä¸­æ ¹æ®URLä¸­çš„nameè¿›è¡Œæƒé™çš„æ ¡éªŒ</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>æ•°æ®åº“æ–¹å¼</li>
</ul>
<p><img src="/post/python/order_trading_platform/1732349583777-e301bcc2-78a6-4951-bd36-e46f5e864674.png"
	
	
	
	loading="lazy"
	
	
></p>
<h4 id="å®ç°çš„å‰ç½®å°çŸ¥è¯†">å®ç°çš„å‰ç½®å°çŸ¥è¯†
</h4><ul>
<li>ä¸­é—´ä»¶</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">process_request</span><span class="err">ï¼Œ</span><span class="n">åŸºäºä»–å®ç°ç”¨æˆ·æ˜¯å¦å·²ç™»å½•</span><span class="err">ï¼Œ</span><span class="n">ç»§ç»­</span><span class="err">ï¼›</span><span class="n">æœªç™»å½•åˆ™è¿”å›ç™»å½•ç•Œé¢</span><span class="err">ã€‚</span>
</span></span><span class="line"><span class="cl">	<span class="o">-</span> <span class="k">return</span> <span class="kc">None</span><span class="err">ï¼Œ</span><span class="n">ç»§ç»­å‘åè®¿é—®</span>
</span></span><span class="line"><span class="cl">	<span class="o">-</span> <span class="k">return</span> <span class="n">å¯¹è±¡</span><span class="err">ï¼Œ</span><span class="n">ç›´æ¥è¿”å›</span><span class="err">ã€‚</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl"><span class="n">process_view</span><span class="err">ï¼Œ</span><span class="n">æƒé™æ ¡éªŒ</span>
</span></span><span class="line"><span class="cl">	<span class="o">-</span> <span class="k">return</span> <span class="kc">None</span><span class="err">ï¼Œ</span><span class="n">ç»§ç»­å‘åè®¿é—®</span>
</span></span><span class="line"><span class="cl">	<span class="o">-</span> <span class="k">return</span> <span class="n">å¯¹è±¡</span><span class="err">ï¼Œ</span><span class="n">ç›´æ¥è¿”å›</span><span class="err">ã€‚</span>
</span></span><span class="line"><span class="cl">	<span class="o">-</span> <span class="n">åœ¨ä»–çš„requestå¯¹è±¡ä¸­æœ‰</span> <span class="n">resolver_match</span>  <span class="err">ï¼Œ</span><span class="n">åŒ…å«å½“å‰è¯·æ±‚çš„è§†å›¾è·¯ç”±ä¿¡æ¯</span>  <span class="o">.</span><span class="n">name</span><span class="o">-&gt;</span><span class="n">sms_login</span>
</span></span><span class="line"><span class="cl">		<span class="n">admin</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sms_login&#39;</span><span class="p">,</span><span class="s2">&#34;xxx&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl"><span class="n">process_response</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>é¢å‘å¯¹è±¡</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">mapping</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;1&#34;</span><span class="p">:</span> <span class="s2">&#34;ADMIN&#34;</span><span class="p">,</span> <span class="s2">&#34;2&#34;</span><span class="p">:</span> <span class="s2">&#34;CUSTOMER&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">request</span><span class="o">.</span><span class="n">session</span><span class="p">[</span><span class="s1">&#39;user_info&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;role&#39;</span><span class="p">:</span> <span class="n">mapping</span><span class="p">[</span><span class="n">role</span><span class="p">],</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">user_object</span><span class="o">.</span><span class="n">username</span><span class="p">,</span> <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="n">user_object</span><span class="o">.</span><span class="n">id</span><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ajaxè¯·æ±‚">ajaxè¯·æ±‚
</h3><ul>
<li>formè¡¨å•</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">form</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;get&#39;</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;xxx&#39;</span> <span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nb">input</span> <span class="o">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nb">input</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;submit&#39;</span> <span class="o">/&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="n">form</span><span class="o">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>ajax</li>
</ul>
<p>Ajaxï¼ˆAsynchronous JavaScript and XMLï¼‰æ˜¯ä¸€ç§åœ¨æ— éœ€é‡æ–°åŠ è½½æ•´ä¸ªé¡µé¢çš„æƒ…å†µä¸‹ï¼Œä¸æœåŠ¡å™¨äº¤æ¢æ•°æ®å¹¶æ›´æ–°éƒ¨åˆ†ç½‘é¡µçš„æŠ€æœ¯ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯åˆ©ç”¨æµè§ˆå™¨ä¸ŠXMLRequest</p>
<p><strong>åŸºæœ¬æ­¥éª¤ï¼š</strong></p>
<ul>
<li>åˆ›å»ºXMLRequestå¯¹è±¡</li>
<li>åˆå§‹åŒ–è¯·æ±‚ï¼šæŒ‡å®šè¯·æ±‚ç±»å‹ä»¥åŠè¯·æ±‚çš„URL</li>
<li>å‘é€è¯·æ±‚</li>
<li>å¤„ç†å“åº”</li>
<li>æ›´æ–°é¡µé¢</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">html</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">head</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/</span><span class="n">head</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">body</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="n">script</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        	 <span class="n">xhr</span> <span class="o">=</span> <span class="n">new</span> <span class="n">XMLHttpRequest</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">             <span class="n">xhr</span><span class="o">.</span><span class="n">onreadystatechange</span> <span class="o">=</span> <span class="n">function</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">                 <span class="k">if</span><span class="p">(</span><span class="n">xhr</span><span class="o">.</span><span class="n">readyState</span> <span class="o">==</span> <span class="mi">4</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">                    <span class="o">//</span> <span class="n">å·²ç»æ¥æ”¶åˆ°å…¨éƒ¨å“åº”æ•°æ®</span><span class="err">ï¼Œ</span><span class="n">æ‰§è¡Œä»¥ä¸‹æ“ä½œ</span>
</span></span><span class="line"><span class="cl">                    <span class="n">var</span> <span class="n">data</span> <span class="o">=</span> <span class="n">xhr</span><span class="o">.</span><span class="n">responseText</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                    <span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">             <span class="p">};</span>
</span></span><span class="line"><span class="cl">             <span class="n">xhr</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;POST&#39;</span><span class="p">,</span> <span class="s2">&#34;/test/&#34;</span><span class="p">,</span> <span class="n">true</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">             <span class="n">xhr</span><span class="o">.</span><span class="n">setRequestHeader</span><span class="p">(</span><span class="s1">&#39;Content-Type&#39;</span><span class="p">,</span> <span class="s1">&#39;application/x-www-form-urlencoded;&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">             <span class="n">xhr</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s1">&#39;n1=1;n2=2;&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;/</span><span class="n">script</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/</span><span class="n">body</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="n">html</span><span class="o">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>åˆ©ç”¨jQueryç±»åº“ï¼Œå†…éƒ¨å°è£…ï¼Œä½¿ç”¨ç®€å•äº†</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">html</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">...</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">body</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="n">script</span> <span class="n">src</span><span class="o">=</span><span class="s1">&#39;jquery.js&#39;</span><span class="o">&gt;&lt;/</span><span class="n">script</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="n">script</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        	<span class="err">$</span><span class="o">.</span><span class="n">ajax</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">                <span class="n">url</span><span class="p">:</span><span class="s2">&#34;....&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nb">type</span><span class="p">:</span><span class="s2">&#34;post&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="n">data</span><span class="p">:{</span><span class="n">n1</span><span class="p">:</span><span class="mi">123</span><span class="p">,</span><span class="n">n2</span><span class="p">:</span><span class="mi">456</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="n">success</span><span class="p">:</span><span class="n">function</span><span class="p">(</span><span class="n">res</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">                    <span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">res</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">})</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;/</span><span class="n">script</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/</span><span class="n">body</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="n">html</span><span class="o">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¤§è‡´åº”ç”¨åœºæ™¯ï¼š</p>
<ul>
<li>æäº¤æ•°æ®ï¼Œé¡µé¢å¯ä»¥åˆ·æ–° -&gt; formè¡¨å•</li>
<li>æäº¤æ•°æ®ï¼Œé¡µé¢ä¸æƒ³åˆ·æ–° -&gt; ajaxå½¢å¼æäº¤</li>
</ul>
<h3 id="csrftoken">csrftoken
</h3><h4 id="formè¡¨å•">formè¡¨å•
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">form</span> <span class="o">...&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span><span class="o">%</span> <span class="n">csrf_token</span> <span class="o">%</span><span class="p">}</span>  
</span></span><span class="line"><span class="cl">	<span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">è¡¨å•å­—æ®µ</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nb">input</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&#34;submit&#34;</span> <span class="n">value</span><span class="o">=</span><span class="s2">&#34;Submit&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="n">form</span><span class="o">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="ajaxæ–¹å¼">ajaxæ–¹å¼
</h4><p>æµè§ˆå™¨æ‰“å¼€ç½‘å€æ—¶ï¼Œdjangoåœ¨cookieä¸­ä¹Ÿç»™æˆ‘ä»¬è¿”å›äº†ä¸€æ®µå€¼ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="err">$</span><span class="o">.</span><span class="n">ajax</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">	<span class="n">url</span><span class="p">:</span><span class="s2">&#34;...&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">	<span class="nb">type</span><span class="p">:</span><span class="s2">&#34;get&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">data</span><span class="p">:{</span><span class="n">user</span><span class="p">:</span><span class="s2">&#34;wupeiqi&#34;</span><span class="p">,</span><span class="n">pwd</span><span class="p">:</span><span class="s2">&#34;xxxx&#34;</span><span class="p">}</span><span class="err">ï¼Œ</span>
</span></span><span class="line"><span class="cl">	<span class="n">header</span><span class="p">:{</span>
</span></span><span class="line"><span class="cl">		<span class="s2">&#34;X-HTTP...&#34;</span><span class="p">:</span><span class="s2">&#34;cookieä¸­å†™çš„é‚£æ®µå€¼&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="p">},</span>
</span></span><span class="line"><span class="cl">	<span class="n">success</span><span class="p">:</span><span class="n">function</span><span class="p">(</span><span class="n">arg</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">		
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="å‘åç«¯å‘é€è¯·æ±‚">å‘åç«¯å‘é€è¯·æ±‚
</h4><ul>
<li>form - GET</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">form</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;GET&#39;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="n">form</span><span class="o">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>form - POST</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">form</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;POST&#39;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span><span class="o">%</span> <span class="n">csrf_token</span> <span class="o">%</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="n">form</span><span class="o">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>ajax - GET</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="err">$</span><span class="o">.</span><span class="n">ajax</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">    <span class="n">url</span><span class="p">:</span> <span class="s2">&#34;/xxx/xx&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nb">type</span><span class="p">:</span> <span class="s2">&#34;GET&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span><span class="p">:</span> <span class="p">{</span><span class="n">mobile</span><span class="p">:</span> <span class="s2">&#34;1888888&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="n">success</span><span class="p">:</span> <span class="n">function</span> <span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">res</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>ajax - POST</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="err">$</span><span class="o">.</span><span class="n">ajax</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">    <span class="n">url</span><span class="p">:</span> <span class="s2">&#34;/xxx/xx&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nb">type</span><span class="p">:</span> <span class="s2">&#34;POST&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span><span class="p">:</span> <span class="p">{</span><span class="n">mobile</span><span class="p">:</span> <span class="s2">&#34;1888888&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="n">headers</span><span class="p">:{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;X-CSRFTOKEN&#34;</span><span class="p">:</span><span class="s2">&#34;....&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="n">success</span><span class="p">:</span> <span class="n">function</span> <span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">res</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>ajax - PUT</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="err">$</span><span class="o">.</span><span class="n">ajax</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">    <span class="n">url</span><span class="p">:</span> <span class="s2">&#34;/xxx/xx&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nb">type</span><span class="p">:</span> <span class="s2">&#34;PUT&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span><span class="p">:</span> <span class="p">{</span><span class="n">mobile</span><span class="p">:</span> <span class="s2">&#34;1888888&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="n">headers</span><span class="p">:{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;X-CSRFTOKEN&#34;</span><span class="p">:</span><span class="s2">&#34;....&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="n">success</span><span class="p">:</span> <span class="n">function</span> <span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">res</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>ajax - DELETE</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="err">$</span><span class="o">.</span><span class="n">ajax</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">    <span class="n">url</span><span class="p">:</span> <span class="s2">&#34;/xxx/xx&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nb">type</span><span class="p">:</span> <span class="s2">&#34;DELETE&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span><span class="p">:</span> <span class="p">{</span><span class="n">mobile</span><span class="p">:</span> <span class="s2">&#34;1888888&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="n">headers</span><span class="p">:{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;X-CSRFTOKEN&#34;</span><span class="p">:</span><span class="s2">&#34;....&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="n">success</span><span class="p">:</span> <span class="n">function</span> <span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">res</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>ajax - serialize</li>
</ul>
<blockquote>
<p>æºå¸¦æ‰€æœ‰å‚æ•°ï¼ŒåŒ…æ‹¬csrftoken</p></blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="err">$</span><span class="o">.</span><span class="n">ajax</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">    <span class="n">url</span><span class="p">:</span><span class="s2">&#34;/sms/login/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nb">type</span><span class="p">:</span><span class="s2">&#34;POST&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span><span class="p">:</span><span class="err">$</span><span class="p">(</span><span class="s2">&#34;#f1&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å¥½å¤„ï¼Œä¸éœ€è¦åŠ csrf header</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="csrfè®¤è¯">csrfè®¤è¯
</h4><ul>
<li>è¯·æ±‚ä½“ä¸­</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">-</span> <span class="n">ä¼ ç»Ÿçš„form</span>
</span></span><span class="line"><span class="cl"><span class="o">-</span> <span class="n">jQuery</span>    <span class="err">$</span><span class="p">(</span><span class="s2">&#34;#smsForm&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>  <span class="o">+</span> <span class="n">Ajax</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>è¯·æ±‚ä½“ä¸­</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="err">$</span><span class="o">.</span><span class="n">ajaxSetup</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">	<span class="n">beforeSend</span><span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">$</span><span class="o">.</span><span class="n">ajax</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">	<span class="n">url</span><span class="p">:</span><span class="s2">&#34;...&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">	<span class="nb">type</span><span class="p">:</span><span class="s2">&#34;GET&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">	<span class="n">data</span><span class="p">:{},</span>
</span></span><span class="line"><span class="cl">	<span class="n">dataType</span><span class="p">:</span><span class="s2">&#34;JSON&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">	<span class="n">headers</span><span class="p">:{</span>
</span></span><span class="line"><span class="cl">		<span class="o">...</span>
</span></span><span class="line"><span class="cl">	<span class="p">},</span>
</span></span><span class="line"><span class="cl">	<span class="n">success</span><span class="p">:</span><span class="n">function</span><span class="p">(</span><span class="n">res</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="djangoçš„è‡ªå®šä¹‰è¯·æ±‚å¤´">djangoçš„è‡ªå®šä¹‰è¯·æ±‚å¤´
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">-</span> <span class="n">è‡ªåŠ¨åŒ–æ·»åŠ </span> <span class="n">HTTP_</span> <span class="n">å‰ç¼€</span>
</span></span><span class="line"><span class="cl"><span class="o">-</span> <span class="n">è‡ªåŠ¨åŒ–æ·»åŠ </span> <span class="n">HTTP_</span> <span class="n">å‰ç¼€</span><span class="err">ï¼Œ</span><span class="n">å‰ç«¯çš„</span><span class="o">-</span><span class="err">ï¼Œ</span><span class="n">è½¬æ¢æˆåç«¯çš„_</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="formç»„ä»¶">formç»„ä»¶
</h3><h4 id="è‡ªå®šä¹‰è¡¨å•ç±»">è‡ªå®šä¹‰è¡¨å•ç±»
</h4><p>Djangoæä¾›äº†ä¸¤ç§è‡ªå®šä¹‰è¡¨å•çš„æ–¹å¼ï¼šç»§æ‰¿<code>Form</code>ç±»å’Œ<code>ModelForm</code>ç±»ã€‚å‰è€…ä½ éœ€è¦è‡ªå®šä¹‰è¡¨å•ä¸­çš„å­—æ®µï¼Œåè€…å¯ä»¥æ ¹æ®Djangoæ¨¡å‹è‡ªåŠ¨ç”Ÿæˆè¡¨å•ï¼Œå¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># app/forms.py</span>
</span></span><span class="line"><span class="cl"><span class="c1"># è‡ªå®šä¹‰è¡¨å•å­—æ®µ</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">django</span> <span class="kn">import</span> <span class="n">forms</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Contact</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">ContactForm1</span><span class="p">(</span><span class="n">forms</span><span class="o">.</span><span class="n">Form</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">name</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&#34;Your Name&#34;</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">email</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">EmailField</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&#34;Email address&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ ¹æ®æ¨¡å‹åˆ›å»º</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">ContactForm2</span><span class="p">(</span><span class="n">forms</span><span class="o">.</span><span class="n">ModelForm</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">model</span> <span class="o">=</span> <span class="n">Contact</span>
</span></span><span class="line"><span class="cl">        <span class="n">fields</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;email&#39;</span><span class="p">,)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p><code>labelç”¨æ¥ç»™å­—æ®µæ·»åŠ ä¸€ä¸ªæè¿°</code></p></blockquote>
<h4 id="è‡ªå®šä¹‰é”™è¯¯å­—æ®µä¿¡æ¯">è‡ªå®šä¹‰é”™è¯¯å­—æ®µä¿¡æ¯
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">django</span> <span class="kn">import</span> <span class="n">forms</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">LoginForm</span><span class="p">(</span><span class="n">forms</span><span class="o">.</span><span class="n">Form</span><span class="p">):</span>  
</span></span><span class="line"><span class="cl">    <span class="n">username</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">max_length</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">min_length</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">error_messages</span><span class="o">=</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;required&#39;</span><span class="p">:</span> <span class="s1">&#39;ç”¨æˆ·åä¸èƒ½ä¸ºç©º&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;max_length&#39;</span><span class="p">:</span> <span class="s1">&#39;ç”¨æˆ·åé•¿åº¦ä¸å¾—è¶…è¿‡20ä¸ªå­—ç¬¦&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;min_length&#39;</span><span class="p">:</span> <span class="s1">&#39;ç”¨æˆ·åé•¿åº¦ä¸å¾—å°‘äº6ä¸ªå­—ç¬¦&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">password</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">max_length</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">min_length</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">error_messages</span><span class="o">=</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;required&#39;</span><span class="p">:</span> <span class="s1">&#39;å¯†ç ä¸èƒ½ä¸ºç©º&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;max_length&#39;</span><span class="p">:</span> <span class="s1">&#39;å¯†ç é•¿åº¦ä¸å¾—è¶…è¿‡20ä¸ªå­—ç¬¦&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;min_length&#39;</span><span class="p">:</span> <span class="s1">&#39;å¯†ç é•¿åº¦ä¸å¾—å°‘äº6ä¸ªå­—ç¬¦&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¯¹äºåŸºç»§æ‰¿<code>ModelForm</code>ç±»çš„è¡¨å•, æˆ‘ä»¬å¯ä»¥åœ¨<code>Meta</code>é€‰é¡¹ä¸‹widgetä¸­æ¥è‡ªå®šä¹‰é”™è¯¯ä¿¡æ¯</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">django.forms</span> <span class="kn">import</span> <span class="n">ModelForm</span><span class="p">,</span> <span class="n">Textarea</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">myapp.models</span> <span class="kn">import</span> <span class="n">Author</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">AuthorForm</span><span class="p">(</span><span class="n">ModelForm</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">model</span> <span class="o">=</span> <span class="n">Author</span>
</span></span><span class="line"><span class="cl">        <span class="n">fields</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;birth_date&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">widgets</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">Textarea</span><span class="p">(</span><span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;cols&#39;</span><span class="p">:</span> <span class="mi">80</span><span class="p">,</span> <span class="s1">&#39;rows&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">}),</span>  <span class="c1"># å…³é”®æ˜¯è¿™ä¸€è¡Œ</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">labels</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Author&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">help_texts</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Some useful help text.&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">error_messages</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s1">&#39;max_length&#39;</span><span class="p">:</span> <span class="s2">&#34;This writer&#39;s name is too long.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="è‡ªå®šä¹‰è¡¨å•è¾“å…¥widget">è‡ªå®šä¹‰è¡¨å•è¾“å…¥<code>widget</code>
</h4><p>Djangoè¡¨å•çš„æ¯ä¸ªå­—æ®µä½ éƒ½å¯ä»¥é€‰æ‹©ä½ å–œæ¬¢çš„è¾“å…¥<code>widget</code>ï¼Œæ¯”å¦‚å¤šé€‰ï¼Œå¤é€‰æ¡†ã€‚ä½ è¿˜å¯ä»¥å®šä¹‰æ¯ä¸ªwidgetçš„csså±æ€§</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">django</span> <span class="kn">import</span> <span class="n">forms</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">ContactForm</span><span class="p">(</span><span class="n">forms</span><span class="o">.</span><span class="n">Form</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">name</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">max_length</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">widget</span><span class="o">=</span><span class="n">forms</span><span class="o">.</span><span class="n">Textarea</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;custom&#39;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="è¡¨å•çš„å®ä¾‹åŒ–ä¸åˆå§‹åŒ–">è¡¨å•çš„å®ä¾‹åŒ–ä¸åˆå§‹åŒ–
</h4><p>å®šä¹‰å¥½ä¸€ä¸ªè¡¨å•ç±»åï¼Œä½ å°±å¯ä»¥å¯¹å…¶è¿›è¡Œå®ä¾‹åŒ–æˆ–åˆå§‹åŒ–ã€‚ä¸‹é¢æ–¹æ³•å¯ä»¥å®ä¾‹åŒ–ä¸€ä¸ªç©ºè¡¨å•ï¼Œä½†é‡Œé¢æ²¡æœ‰ä»»ä½•æ•°æ®ï¼Œå¯ä»¥é€šè¿‡ <code>{{ form }}</code>åœ¨æ¨¡æ¿ä¸­æ¸²æŸ“</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">form</span> <span class="o">=</span> <span class="n">ContactForm</span><span class="p">()</span> <span class="c1"># ç©ºè¡¨å•</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æœ‰æ—¶æˆ‘ä»¬éœ€è¦å¯¹è¡¨å•è®¾ç½®ä¸€äº›åˆå§‹æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡<code>initial</code>æ–¹æ³•æˆ–è®¾ç½®<code>default_data</code>ï¼Œå¦‚ä¸‹æ‰€ç¤º</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># initialæ–¹æ³•åˆå§‹åŒ–</span>
</span></span><span class="line"><span class="cl"><span class="n">form</span> <span class="o">=</span> <span class="n">ContactForm</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">initial</span><span class="o">=</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;First and Last Name&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">},)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># default_dataé»˜è®¤å€¼</span>
</span></span><span class="line"><span class="cl"><span class="n">default_data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;John&#39;</span><span class="p">,</span> <span class="s1">&#39;email&#39;</span><span class="p">:</span> <span class="s1">&#39;someone@hotmail.com&#39;</span><span class="p">,</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">form</span> <span class="o">=</span> <span class="n">ContactForm</span><span class="p">(</span><span class="n">default_data</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç”¨æˆ·æäº¤çš„æ•°æ®å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹æ³•ä¸è¡¨å•ç»“åˆï¼Œç”Ÿæˆä¸æ•°æ®ç»“åˆè¿‡çš„è¡¨å•(Bound forms)ã€‚Djangoåªèƒ½å¯¹Bound formsè¿›è¡ŒéªŒè¯</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">form</span> <span class="o">=</span> <span class="n">ContactForm</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">FILES</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å…¶ç¼–è¾‘ä¿®æ”¹ç±»åº”ç”¨åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬è¿˜è¦ç»™è¡¨å•æä¾›ç°æœ‰å¯¹è±¡å®ä¾‹çš„æ•°æ®ï¼Œè€Œä¸æ˜¯æ¸²æŸ“ä¸€å¼ ç©ºè¡¨å•ï¼Œè¿™æ—¶æˆ‘ä»¬å¯è¿™ä¹ˆåšã€‚è¯¥æ–¹æ³•ä»…é€‚ç”¨äºç”±æ¨¡å‹åˆ›å»ºçš„<code>ModelForm</code>ï¼Œè€Œä¸é€‚ç”¨äºè‡ªå®šä¹‰çš„è¡¨å•</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">contact</span> <span class="o">=</span> <span class="n">Contact</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">form</span> <span class="o">=</span>  <span class="n">ContactForm</span><span class="p">(</span><span class="n">instance</span> <span class="o">=</span> <span class="n">contact</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="è¡¨å•çš„ä½¿ç”¨">è¡¨å•çš„ä½¿ç”¨
</h4><h4 id="ç»§æ‰¿formç±»">ç»§æ‰¿Formç±»
</h4><ul>
<li>ç¼–å†™å­—æ®µ</li>
</ul>
<p>è‡ªå®šä¹‰ç¼–å†™</p>
<ul>
<li>ç”ŸæˆHTMLæ ‡ç­¾ + æºå¸¦æ•°æ®</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">-</span> <span class="n">ä¿ç•™åŸæ¥æäº¤çš„æ•°æ®</span><span class="err">ï¼Œ</span><span class="n">ä¸å†æ‹…å¿ƒformè¡¨å•æäº¤æ—¶é¡µé¢åˆ·æ–°</span><span class="err">ã€‚</span>
</span></span><span class="line"><span class="cl"><span class="o">-</span> <span class="n">æ˜¾ç¤ºé»˜è®¤å€¼</span><span class="err">ï¼Œ</span><span class="n">åšç¼–è¾‘é¡µé¢æ˜¾ç¤ºé»˜è®¤å€¼</span><span class="err">ã€‚</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>æ•°æ®æ ¡éªŒï¼Œå¯¹ç”¨æˆ·æäº¤çš„æ•°æ®æ ¼å¼æ ¡éªŒ</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">form</span> <span class="o">=</span> <span class="n">LoginForm</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">form</span><span class="o">.</span><span class="n">is_valid</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">form</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">form</span><span class="o">.</span><span class="n">errors</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="ç»§æ‰¿modelformç±»">ç»§æ‰¿ModelFormç±»
</h4><ul>
<li>ç¼–å†™å­—æ®µ</li>
</ul>
<p>é€‰æ‹©å­—æ®µ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">LevelModelForm</span><span class="p">(</span><span class="n">forms</span><span class="o">.</span><span class="n">ModelForm</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">model</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Level</span>  <span class="c1"># æŒ‡å®šå¼•ç”¨çš„è¡¨å</span>
</span></span><span class="line"><span class="cl">        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;percent&#39;</span><span class="p">]</span>  <span class="c1"># å¼•ç”¨çš„å­—æ®µ</span>
</span></span><span class="line"><span class="cl">        <span class="n">fields</span> <span class="o">=</span> <span class="s2">&#34;__all__&#34;</span>  <span class="c1"># å¼•ç”¨å…¨éƒ¨å­—æ®µ</span>
</span></span><span class="line"><span class="cl">		<span class="n">exclude</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;active&#39;</span><span class="p">]</span>  <span class="c1"># æ’é™¤æŸä¸€å­—æ®µ</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ·»åŠ è‡ªå®šä¹‰å­—æ®µ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">LevelModelForm</span><span class="p">(</span><span class="n">BootStrapForm</span><span class="p">,</span> <span class="n">forms</span><span class="o">.</span><span class="n">ModelForm</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">xxx</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;xxx&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">model</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Level</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># fields = &#34;__all__&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># exclude = [&#39;active&#39;]</span>
</span></span><span class="line"><span class="cl">        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;xxx&#39;</span><span class="p">,</span> <span class="s1">&#39;percent&#39;</span><span class="p">,</span> <span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>é‡å†™å­—æ®µ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">LevelModelForm</span><span class="p">(</span><span class="n">BootStrapForm</span><span class="p">,</span> <span class="n">forms</span><span class="o">.</span><span class="n">ModelForm</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">title</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">ChoiceField</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;xxx&#39;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&#34;xxx&#34;</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&#34;xxxxxx&#34;</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">model</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Level</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># fields = &#34;__all__&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># exclude = [&#39;active&#39;]</span>
</span></span><span class="line"><span class="cl">        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;percent&#39;</span><span class="p">,</span> <span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>ç”ŸæˆHTMLæ ‡ç­¾ + æ’ä»¶ + å‚æ•°çš„é…ç½®</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">LevelModelForm</span><span class="p">(</span><span class="n">BootStrapForm</span><span class="p">,</span> <span class="n">forms</span><span class="o">.</span><span class="n">ModelForm</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">model</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Level</span>
</span></span><span class="line"><span class="cl">        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;percent&#39;</span><span class="p">,</span> <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">widgets</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">forms</span><span class="o">.</span><span class="n">PasswordInput</span><span class="p">(</span><span class="n">render_value</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>è¡¨å•éªŒè¯</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">LevelModelForm</span><span class="p">(</span><span class="n">BootStrapForm</span><span class="p">,</span> <span class="n">forms</span><span class="o">.</span><span class="n">ModelForm</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">title</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">validators</span><span class="o">=</span><span class="p">[])</span>
</span></span><span class="line"><span class="cl">    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">model</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Level</span>
</span></span><span class="line"><span class="cl">        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;percent&#39;</span><span class="p">,</span> <span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">clean_percent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;percent&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">value</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>ä¿å­˜æ›´æ–°</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">form</span> <span class="o">=</span> <span class="n">LevelModelForm</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">form</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">form</span> <span class="o">=</span> <span class="n">LevelModelForm</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">,</span><span class="n">install</span><span class="o">=</span><span class="n">å¯¹è±¡</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">form</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># è¾“å…¥å­—æ®µå°‘äºæ•°æ®åº“ï¼Œæ‰‹åŠ¨æ·»åŠ </span>
</span></span><span class="line"><span class="cl"><span class="c1"># è¾“å…¥å­—æ®µå¤šä½™æ•°æ®åº“b</span>
</span></span><span class="line"><span class="cl"><span class="n">form</span> <span class="o">=</span> <span class="n">LevelModelForm</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">)</span> <span class="c1"># æˆ–æœ‰ ,install=å¯¹è±¡</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">form</span><span class="o">.</span><span class="n">instance</span><span class="o">.</span><span class="n">percent</span> <span class="o">=</span> <span class="mi">10</span>
</span></span><span class="line"><span class="cl"><span class="n">form</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="formçš„æ ¡éªŒæµç¨‹">formçš„æ ¡éªŒæµç¨‹
</h4><ul>
<li>æ¯ä¸ªå­—æ®µçš„å†…éƒ¨ï¼šrequired + validators + min_length + max_length</li>
<li>æ¯ä¸ªå­—æ®µçš„é’©å­æ–¹æ³•</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">clean_username</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">user</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># æ ¡éªŒè§„åˆ™</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># æ ¡éªŒå¤±è´¥</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">user</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="kn">from</span> <span class="nn">django.core.exceptions</span> <span class="kn">import</span> <span class="n">ValidationError</span>
</span></span><span class="line"><span class="cl">        <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s2">&#34;ç”¨æˆ·åæ ¼å¼é”™è¯¯&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">user</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">form</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>clean</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">clean</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># å¯¹æ‰€æœ‰å€¼è¿›è¡Œæ ¡éªŒ</span>
</span></span><span class="line"><span class="cl">    <span class="kn">from</span> <span class="nn">django.core.exceptions</span> <span class="kn">import</span> <span class="n">ValidationError</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 1.ä¸è¿”å›å€¼ï¼Œé»˜è®¤ self.cleaned_data</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 2.è¿”å›å€¼ï¼Œself.cleaned_data=è¿”å›çš„å€¼</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 3.æŠ¥é”™ï¼ŒValidationError -&gt;  self.add_error(None, e)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>_post_clean</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">_post_clean</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">pass</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>formç›®çš„ï¼šç”Ÿæˆæ ‡ç­¾ + æ ¡éªŒ</li>
<li>ç”Ÿæˆæ ‡ç­¾
<ul>
<li>å¾ªç¯ + å•ç‹¬æŸä¸ªå­—æ®µ</li>
<li>labelé¡µé¢æ˜¾ç¤ºæ–‡æœ¬ä¿¡æ¯</li>
<li>è‡ªå®šä¹‰é”™è¯¯ä½ç½®ï¼Œposition</li>
</ul>
</li>
<li>æ ¡éªŒ
<ul>
<li>å®šä¹‰
<ul>
<li>æ¯ä¸ªå­—æ®µæ ¡éªŒ
<ul>
<li>å­—æ®µä¸Šå®šä¹‰æ ¡éªŒè§„åˆ™ æ­£åˆ™ã€ç©ºã€é•¿åº¦</li>
<li>clean_æ–¹æ³•å</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">æ ¡éªŒæˆåŠŸ</span><span class="err">ï¼š</span>
</span></span><span class="line"><span class="cl">	<span class="bp">self</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s2">&#34;å­—æ®µ&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">å€¼</span>
</span></span><span class="line"><span class="cl"><span class="n">æ ¡éªŒå¤±è´¥</span>
</span></span><span class="line"><span class="cl">	<span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">[</span><span class="s2">&#34;å­—æ®µ&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">é”™è¯¯</span>
</span></span></code></pre></td></tr></table>
</div>
</div><pre><code>    * æ‰€æœ‰å­—æ®µæ ¡éªŒ
        + clean
</code></pre>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">cleaned_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">clean</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="bp">self</span><span class="o">.</span><span class="n">add_error</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">cleaned_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">cleaned_data</span> <span class="o">=</span> <span class="n">cleaned_data</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl"><span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">[</span><span class="s2">&#34;__all__&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">é”™è¯¯</span>
</span></span></code></pre></td></tr></table>
</div>
</div><pre><code>        + _post_clean
- æ ¡éªŒæºç 
    * form.is_valid
    * form.errors
    * form.fuull_clean()
- ä¸šåŠ¡æ ¡éªŒ
</code></pre>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">form</span> <span class="o">=</span> <span class="n">å¯¹è±¡</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="ow">not</span> <span class="n">form</span><span class="o">.</span><span class="n">is_valid</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">form</span><span class="o">.</span><span class="n">errors</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">form</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">username</span><span class="mf">.0</span>
</span></span><span class="line"><span class="cl">    <span class="n">form</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="fm">__call__</span><span class="mf">.0</span>   <span class="o">-&gt;</span>  <span class="n">æ¨¡æ¿è¯­è¨€ä¸­</span> <span class="n">form</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">__</span> <span class="n">ä¸æ”¯æŒ</span>
</span></span><span class="line"><span class="cl">    <span class="n">form</span><span class="o">.</span><span class="n">non_field_errors</span><span class="p">()</span>  <span class="o">&lt;==&gt;</span> <span class="n">form</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="fm">__call__</span>
</span></span><span class="line"><span class="cl">    <span class="n">åœ¨é¡µé¢ä¸Šå»é€‚åˆçš„ä½ç½®æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">form</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/post/python/order_trading_platform/1732377343476-dfd6b6b1-1b53-4861-b14a-40c18d8dfacc.png"
	
	
	
	loading="lazy"
	
	
></p>
<pre><code>- æ‹“å±•
</code></pre>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">å¦‚æœæƒ³è¦è®©æŸä¸ªé”™è¯¯ä¿¡æ¯</span><span class="err">ï¼Œ</span><span class="n">å±•ç¤ºåœ¨ç‰¹å®šçš„å­—æ®µæ—</span><span class="err">ï¼Œ</span><span class="n">å°±å¯ä»¥ä½¿ç”¨</span><span class="err">ï¼š</span>
</span></span><span class="line"><span class="cl"><span class="n">form</span><span class="o">.</span><span class="n">add_error</span><span class="p">(</span><span class="s2">&#34;password&#34;</span><span class="p">,</span> <span class="s2">&#34;ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/post/python/order_trading_platform/1732377389035-fddedf5e-b105-4d35-80bd-b17ab91f489a.png"
	
	
	
	loading="lazy"
	
	
></p>
<h4 id="formæ ·å¼è®¾ç½®">formæ ·å¼è®¾ç½®
</h4><p>æ€è€ƒï¼šæ— è®ºåœ¨ä½¿ç”¨Formè¿˜æ˜¯ModelFormæ—¶ï¼Œæƒ³è¦è®©é¡µé¢å¥½çœ‹ï¼Œå°±éœ€è¦å°†æ¯ä¸ªå­—æ®µçš„æ’ä»¶ä¸­ç»™ä»–è®¾ç½®form-controlæ ·å¼</p>
<h5 id="å¾ªç¯å†™å…¥">å¾ªç¯å†™å…¥
</h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">LevelForm</span><span class="p">(</span><span class="n">forms</span><span class="o">.</span><span class="n">Form</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">title</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">label</span><span class="o">=</span><span class="s2">&#34;æ ‡é¢˜&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># widget=forms.TextInput(attrs={&#34;class&#34;: &#34;form-control&#34;, &#39;placeholder&#39;: &#34;è¯·è¾“å…¥æ ‡é¢˜&#34;}),</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">percent</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">label</span><span class="o">=</span><span class="s2">&#34;æŠ˜æ‰£&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">help_text</span><span class="o">=</span><span class="s2">&#34;å¡«å…¥0-100æ•´æ•°è¡¨ç¤ºç™¾åˆ†æ¯”ï¼Œä¾‹å¦‚ï¼š90ï¼Œè¡¨ç¤º90%&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># {&#39;title&#39;:å¯¹è±¡,&#34;percent&#34;:å¯¹è±¡}</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">name</span><span class="p">,</span><span class="n">field</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">            <span class="n">field</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;form-control&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="n">field</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;placeholder&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;è¯·è¾“å…¥</span><span class="si">{}</span><span class="s2">&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">LevelModelForm</span><span class="p">(</span><span class="n">forms</span><span class="o">.</span><span class="n">ModelForm</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">model</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Level</span>
</span></span><span class="line"><span class="cl">        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;percent&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># {&#39;title&#39;:å¯¹è±¡,&#34;percent&#34;:å¯¹è±¡}</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">name</span><span class="p">,</span><span class="n">field</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">            <span class="n">field</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;form-control&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="n">field</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;placeholder&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;è¯·è¾“å…¥</span><span class="si">{}</span><span class="s2">&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="bootstrapæ ·å¼ä¼˜åŒ–">Bootstrapæ ·å¼ä¼˜åŒ–
</h5><h5 id="superå…³é”®å­—">superå…³é”®å­—
</h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">superæ˜¯æ‰¾çˆ¶ç±»ä¸­çš„æˆå‘˜å—</span><span class="err">ï¼Ÿ</span><span class="n">ä¸å‡†ç¡®</span><span class="err">ã€‚</span>
</span></span><span class="line"><span class="cl"><span class="nb">super</span><span class="p">,</span><span class="n">å°±æ˜¯æ ¹æ®ç±»çš„ç»§æ‰¿å…³ç³»</span><span class="err">ï¼ˆ</span><span class="n">mro</span><span class="err">ï¼‰ï¼Œ</span><span class="n">é€æ­¥æ™šä¸Šæ‰¾</span><span class="err">ã€‚</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Base</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">f1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Base&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Foo</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">	<span class="k">pass</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Bar</span><span class="p">(</span><span class="n">Foo</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">f1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Bar&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">f1</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">obj</span> <span class="o">=</span> <span class="n">Bar</span><span class="p">()</span>  <span class="c1"># [Bar,Foo,Base]</span>
</span></span><span class="line"><span class="cl"><span class="n">obj</span><span class="o">.</span><span class="n">f1</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Bar Base</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Base</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">f1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Base&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Foo</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">f1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Foo&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">f1</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Bar</span><span class="p">(</span><span class="n">Foo</span><span class="p">,</span><span class="n">Base</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">f1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Bar&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">f1</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl"><span class="n">obj</span> <span class="o">=</span> <span class="n">Bar</span><span class="p">()</span>  <span class="c1"># [Bar,Foo,Base]</span>
</span></span><span class="line"><span class="cl"><span class="n">obj</span><span class="o">.</span><span class="n">f1</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Bar Foo Base</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Base</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">f1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Base&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Foo</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">f1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Foo&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">f1</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Bar</span><span class="p">(</span><span class="n">Foo</span><span class="p">,</span><span class="n">Base</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">f1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Bar&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">f1</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl"><span class="n">obj</span> <span class="o">=</span> <span class="n">Foo</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">obj</span><span class="o">.</span><span class="n">f1</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Foo</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">render</span><span class="p">,</span> <span class="n">redirect</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">web</span> <span class="kn">import</span> <span class="n">models</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">django</span> <span class="kn">import</span> <span class="n">forms</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">reverse</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">BootStrapForm</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1"># {&#39;title&#39;:å¯¹è±¡,&#34;percent&#34;:å¯¹è±¡}</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">            <span class="n">field</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;form-control&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="n">field</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;placeholder&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;è¯·è¾“å…¥</span><span class="si">{}</span><span class="s2">&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">LevelForm</span><span class="p">(</span><span class="n">BootStrapForm</span><span class="p">,</span> <span class="n">forms</span><span class="o">.</span><span class="n">Form</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">title</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">label</span><span class="o">=</span><span class="s2">&#34;æ ‡é¢˜&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">percent</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">label</span><span class="o">=</span><span class="s2">&#34;æŠ˜æ‰£&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">help_text</span><span class="o">=</span><span class="s2">&#34;å¡«å…¥0-100æ•´æ•°è¡¨ç¤ºç™¾åˆ†æ¯”ï¼Œä¾‹å¦‚ï¼š90ï¼Œè¡¨ç¤º90%&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">LevelModelForm</span><span class="p">(</span><span class="n">BootStrapForm</span><span class="p">,</span> <span class="n">forms</span><span class="o">.</span><span class="n">ModelForm</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">model</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Level</span>
</span></span><span class="line"><span class="cl">        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;percent&#39;</span><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="å±€éƒ¨å»é™¤bootstrapæ ·å¼--ä¿®æ”¹å­—æ®µæ ·å¼">å±€éƒ¨å»é™¤bootstrapæ ·å¼ + ä¿®æ”¹å­—æ®µæ ·å¼
</h5><p><img src="/post/python/order_trading_platform/1732416059542-81dab9ba-f776-472d-8ab7-f55dfc0324fb.png"
	
	
	
	loading="lazy"
	
	
></p>
<p>åŸç†ï¼š</p>
<p><img src="/post/python/order_trading_platform/1732416076683-02a8e815-2209-4c5d-ace3-ef48620a4ed6.png"
	
	
	
	loading="lazy"
	
	
></p>
<h4 id="formç»„ä»¶åŸºæœ¬æ“ä½œ">formç»„ä»¶åŸºæœ¬æ“ä½œ
</h4><h5 id="æ˜¾ç¤ºé»˜è®¤å€¼">æ˜¾ç¤ºé»˜è®¤å€¼
</h5><ul>
<li>Form</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">form</span> <span class="o">=</span> <span class="n">LevelForm</span><span class="p">(</span><span class="n">initial</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s2">&#34;xxx&#34;</span><span class="p">})</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>ModelForm</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">form</span> <span class="o">=</span> <span class="n">LevelForm</span><span class="p">(</span><span class="n">initial</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s2">&#34;xxx&#34;</span><span class="p">})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">level_object</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Level</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">pk</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">form</span> <span class="o">=</span> <span class="n">LevelModelForm</span><span class="p">(</span><span class="n">instance</span><span class="o">=</span><span class="n">level_object</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="model">Model
</h3><h4 id="ä¿®æ”¹æŸ¥è¯¢æ¡ä»¶">ä¿®æ”¹æŸ¥è¯¢æ¡ä»¶
</h4><ul>
<li>modelsä¸­çš„limit_choice_toå­—æ®µ</li>
</ul>
<p><img src="/post/python/order_trading_platform/1732415713151-2d59c2e8-efcd-451a-a38e-34eca240a6da.png"
	
	
	
	loading="lazy"
	
	
></p>
<ul>
<li>è‡ªå®šä¹‰choiceså’Œqueryset</li>
</ul>
<p><img src="/post/python/order_trading_platform/1732415742966-cf853046-b791-41e2-a730-d50c7f021ef2.png"
	
	
	
	loading="lazy"
	
	
></p>
<p>ä¼ å…¥requestä»¥ä¾¿åç»­æ¡ä»¶å¤æ‚åŒ–</p>
<h3 id="æ¨¡æ¿">æ¨¡æ¿
</h3><h4 id="æ¯ç‰ˆ">æ¯ç‰ˆ
</h4><h4 id="inclusion_tag">inclusion_tag
</h4><h3 id="é˜Ÿåˆ—">é˜Ÿåˆ—
</h3><p><img src="/post/python/order_trading_platform/1732349610537-4e709222-39a3-4489-b719-1cd4e1008d0e.png"
	
	
	
	loading="lazy"
	
	
></p>
<ul>
<li>rabbitMQï¼ŒLinuxå‘½ä»¤+æœåŠ¡æ„å»º+pythonä»£ç ã€‚</li>
<li>kafkaï¼ŒLinuxå‘½ä»¤+æœåŠ¡æ„å»º+pythonä»£ç ã€‚</li>
<li>redisçš„åˆ—è¡¨</li>
</ul>
<p><img src="/post/python/order_trading_platform/1732349626708-a5c87e69-4f8d-42f0-816e-4751167eb4aa.png"
	
	
	
	loading="lazy"
	
	
></p>
<p>åŸºäºrediså®ç°ä¸Šè¿°åŠŸèƒ½çš„è¿‡ç¨‹å’Œä»£ç ç¤ºä¾‹ï¼š</p>
<ul>
<li>å®‰è£…redis</li>
<li>å¯åŠ¨redis</li>
<li>pythonæ“ä½œredis</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">pip</span> <span class="n">install</span> <span class="n">redis</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">redis</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">conn</span> <span class="o">=</span> <span class="n">redis</span><span class="o">.</span><span class="n">Redis</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;127.0.0.1&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">6379</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;qwe123&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># çŸ­ä¿¡éªŒè¯ç </span>
</span></span><span class="line"><span class="cl"><span class="n">conn</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;15131255089&#39;</span><span class="p">,</span> <span class="mi">9999</span><span class="p">,</span> <span class="n">ex</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">value</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;15131255089&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">redis</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">conn</span> <span class="o">=</span> <span class="n">redis</span><span class="o">.</span><span class="n">Redis</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;127.0.0.1&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">6379</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;qwe123&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ”¾å€¼</span>
</span></span><span class="line"><span class="cl"><span class="c1"># conn.lpush(&#39;my_queue&#39;, &#34;root&#34;)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># conn.lpush(&#39;my_queue&#39;, &#34;good&#34;)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å–å€¼</span>
</span></span><span class="line"><span class="cl"><span class="n">v1</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">brpop</span><span class="p">(</span><span class="s2">&#34;my_queue&#34;</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="workerå’Œçº¿æ€§æ± ">workerå’Œçº¿æ€§æ± 
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># 1.å»redisä¸­è·å–ä»»åŠ¡</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 2.å†å°†æ­¤è®¢å•åœ¨æ•°æ®åº“ä¸­çš„çŠ¶æ€ä¿®æ”¹ä¸º æ‰§è¡Œä¸­</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 3.è·å–ä»»åŠ¡è¯¦ç»†ï¼š è§†é¢‘ï¼Œ10000</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 4.çº¿ç¨‹æ± æˆ–åç¨‹</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">concurrent.futures</span> <span class="kn">import</span> <span class="n">ThreadPoolExecutor</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">task</span><span class="p">(</span><span class="n">video_url</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># æ ¹æ®è§†é¢‘åœ°å€å®ç°åˆ·æ’­æ”¾</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># ..</span>
</span></span><span class="line"><span class="cl">    <span class="k">pass</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">pool</span> <span class="o">=</span> <span class="n">ThreadPoolExecutor</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10000</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">pool</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="s2">&#34;è§†é¢‘åœ°å€&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">pool</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span>  <span class="c1"># å¡ä¸»ï¼Œç­‰å¾…æ‰€æœ‰çš„ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ã€‚</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 5.æ›´æ–°è®¢å•çŠ¶æ€ï¼Œå·²å®Œæˆ</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="åˆ†é¡µç»„ä»¶">åˆ†é¡µç»„ä»¶
</h3><h4 id="é€‰é¡¹ç”Ÿæˆ">é€‰é¡¹ç”Ÿæˆ
</h4><p><img src="/post/python/order_trading_platform/1732416637414-b8a1fbc2-d88a-49e0-b546-5326800b9acc.png"
	
	
	
	loading="lazy"
	
	
></p>
<h4 id="é¡µç é€»è¾‘å’ŒåŠ¨æ€é¡µç ">é¡µç é€»è¾‘å’ŒåŠ¨æ€é¡µç 
</h4><p><img src="/post/python/order_trading_platform/1732416707994-199c0f3d-c70c-4632-9c20-c95ab4bea4ea.png"
	
	
	
	loading="lazy"
	
	
></p>
<h4 id="åˆ†é¡µç»„ä»¶çš„å°è£…">åˆ†é¡µç»„ä»¶çš„å°è£…
</h4><p><img src="/post/python/order_trading_platform/1732416742666-835e5124-e6cd-41aa-a4a2-489e5b271587.png"
	
	
	
	loading="lazy"
	
	
></p>
<h4 id="ä¼˜åŒ–">ä¼˜åŒ–
</h4><p>åŠ å…¥é¦–é¡µã€å°¾é¡µã€ä¸Šä¸€é¡µã€ä¸‹ä¸€é¡µ</p>
<p><img src="/post/python/order_trading_platform/1732416785524-9beb4d22-b0bb-4af7-80c0-e50edd5b94f9.png"
	
	
	
	loading="lazy"
	
	
></p>
<h4 id="querydict">querydict
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0.0.1</span><span class="p">:</span><span class="mi">8000</span><span class="o">/</span><span class="n">customer</span><span class="o">/</span><span class="nb">list</span><span class="o">/</span><span class="err">?</span><span class="nb">filter</span><span class="o">=</span><span class="n">wupeiqi</span><span class="o">&amp;</span><span class="n">age</span><span class="o">=</span><span class="mi">19</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">request</span><span class="o">.</span><span class="n">GET</span>  <span class="n">å¯¹è±¡</span>    <span class="n">QueryDictç±»å‹</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">1.</span><span class="n">é»˜è®¤QueryDictä¸å…è®¸è¢«ä¿®æ”¹</span> <span class="n">_mutable</span><span class="o">=</span><span class="kc">False</span>
</span></span><span class="line"><span class="cl">	<span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">_mutable</span> <span class="o">=</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">2.</span><span class="n">è®¾ç½®å€¼</span>
</span></span><span class="line"><span class="cl">	<span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">setlist</span><span class="p">(</span><span class="s2">&#34;name&#34;</span><span class="p">,[</span><span class="mi">123</span><span class="p">])</span>    <span class="c1"># filter=wupeiqi&amp;age=19&amp;name=123</span>
</span></span><span class="line"><span class="cl">	<span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">setlist</span><span class="p">(</span><span class="s2">&#34;name&#34;</span><span class="p">,[</span><span class="mi">123</span><span class="p">,</span><span class="mi">32</span><span class="p">])</span> <span class="c1"># filter=wupeiqi&amp;age=19&amp;name=123&amp;name=32</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">3.</span><span class="n">è°ƒç”¨urlencodeæ–¹æ³•</span><span class="err">ï¼Œ</span><span class="n">å¯ä»¥æ‹¼æ¥</span>
</span></span><span class="line"><span class="cl">	<span class="n">paramString</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">urlencode</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">	<span class="nb">print</span><span class="p">(</span><span class="n">paramString</span><span class="p">)</span> <span class="s2">&#34;filter=wupeiqi&amp;age=19&amp;name=123&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">------</span><span class="n">æµ‹è¯•</span><span class="o">-----</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">copy</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">query_dict</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">query_dict</span><span class="o">.</span><span class="n">_mutable</span> <span class="o">=</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl"><span class="n">query_dict</span><span class="o">.</span><span class="n">setlist</span><span class="p">(</span><span class="s1">&#39;page&#39;</span><span class="p">,[</span><span class="mi">1</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">paramString</span> <span class="o">=</span> <span class="n">query_dict</span><span class="o">.</span><span class="n">urlencode</span><span class="p">()</span> <span class="s2">&#34;filter=wupeiqi&amp;age=19&amp;page=1&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">query_dict</span><span class="o">.</span><span class="n">_mutable</span> <span class="o">=</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl"><span class="n">query_dict</span><span class="o">.</span><span class="n">setlist</span><span class="p">(</span><span class="s1">&#39;page&#39;</span><span class="p">,[</span><span class="mi">2</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">paramString</span> <span class="o">=</span> <span class="n">query_dict</span><span class="o">.</span><span class="n">urlencode</span><span class="p">()</span> <span class="s2">&#34;filter=wupeiqi&amp;age=19&amp;page=2&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">_mutable</span> <span class="o">=</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl"><span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">setlist</span><span class="p">(</span><span class="s1">&#39;page&#39;</span><span class="p">,[</span><span class="mi">3</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">paramString</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">urlencode</span><span class="p">()</span> <span class="s2">&#34;filter=wupeiqi&amp;age=19&amp;page=3&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="è§£å†³urlå‚æ•°æºå¸¦é—®é¢˜">è§£å†³urlå‚æ•°æºå¸¦é—®é¢˜
</h4><p><img src="/post/python/order_trading_platform/1732416996115-a1389f86-7e9a-44bc-98c3-4d33f67f01b7.png"
	
	
	
	loading="lazy"
	
	
></p>
<h4 id="æœ€ç»ˆç‰ˆ">æœ€ç»ˆç‰ˆ
</h4><h3 id="æœç´¢ç»„ä»¶">æœç´¢ç»„ä»¶
</h3><h4 id="qå¯¹è±¡">Qå¯¹è±¡
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">djangoä¸­æœ‰ä¸ªQå¯¹è±¡</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">models</span><span class="o">.</span><span class="n">XX</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">models</span><span class="o">.</span><span class="n">XX</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">id__gt</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">models</span><span class="o">.</span><span class="n">XX</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">id__gte</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">models</span><span class="o">.</span><span class="n">XX</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">name__contains</span><span class="o">=</span><span class="s2">&#34;xx&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">models</span><span class="o">.</span><span class="n">XX</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">19</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">æ–¹å¼1</span><span class="err">ï¼š</span>
</span></span><span class="line"><span class="cl">	<span class="n">models</span><span class="o">.</span><span class="n">XX</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span> <span class="n">Q</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="p">)</span>	
</span></span><span class="line"><span class="cl">	<span class="n">models</span><span class="o">.</span><span class="n">XX</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span> <span class="n">Q</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span><span class="o">&amp;</span><span class="n">Q</span><span class="p">(</span><span class="n">age</span><span class="o">=</span><span class="mi">19</span><span class="p">)</span> <span class="p">)</span>	
</span></span><span class="line"><span class="cl">	<span class="n">models</span><span class="o">.</span><span class="n">XX</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span> <span class="n">Q</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span><span class="o">|</span><span class="n">Q</span><span class="p">(</span><span class="n">age</span><span class="o">=</span><span class="mi">19</span><span class="p">)</span> <span class="p">)</span>	
</span></span><span class="line"><span class="cl">	<span class="n">models</span><span class="o">.</span><span class="n">XX</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span> <span class="n">Q</span><span class="p">(</span><span class="n">id__gt</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span><span class="o">|</span><span class="n">Q</span><span class="p">(</span><span class="n">age__lte</span><span class="o">=</span><span class="mi">19</span><span class="p">)</span> <span class="p">)</span>	
</span></span><span class="line"><span class="cl">	<span class="n">models</span><span class="o">.</span><span class="n">XX</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span> <span class="n">Q</span><span class="p">(</span> <span class="n">Q</span><span class="p">(</span><span class="n">id__gt</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span><span class="o">|</span><span class="n">Q</span><span class="p">(</span><span class="n">age__lte</span><span class="o">=</span><span class="mi">19</span><span class="p">)</span> <span class="p">)</span> <span class="o">&amp;</span> <span class="n">Q</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="mi">19</span><span class="p">))</span>	
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">æ–¹å¼2</span><span class="err">ï¼š</span>
</span></span><span class="line"><span class="cl">	<span class="n">q1</span> <span class="o">=</span> <span class="n">Q</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">	<span class="n">q1</span><span class="o">.</span><span class="n">connector</span> <span class="o">=</span> <span class="s1">&#39;OR&#39;</span>
</span></span><span class="line"><span class="cl">	<span class="n">q1</span><span class="o">.</span><span class="n">children</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">	<span class="n">q1</span><span class="o">.</span><span class="n">children</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>      <span class="nb">id</span><span class="o">=</span><span class="mi">1</span> <span class="ow">or</span> <span class="n">age</span><span class="o">=</span><span class="mi">10</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">q2</span> <span class="o">=</span> <span class="n">Q</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">	<span class="n">q2</span><span class="o">.</span><span class="n">connector</span> <span class="o">=</span> <span class="s1">&#39;ADN&#39;</span>
</span></span><span class="line"><span class="cl">	<span class="n">q2</span><span class="o">.</span><span class="n">children</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;size__gt&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">	<span class="n">q2</span><span class="o">.</span><span class="n">children</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;root&#39;</span><span class="p">))</span>   <span class="n">size</span><span class="o">&gt;</span><span class="mi">10</span> <span class="ow">and</span>  <span class="n">name</span><span class="o">=</span><span class="n">root</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">con</span> <span class="o">=</span> <span class="n">Q</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">	<span class="n">con</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span> <span class="s1">&#39;AND&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">con</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">q2</span><span class="p">,</span> <span class="s1">&#39;AND&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">1</span> <span class="ow">or</span> <span class="n">age</span><span class="o">=</span><span class="mi">10</span> <span class="p">)</span>  <span class="n">AND</span> <span class="p">(</span><span class="n">size</span><span class="o">&gt;</span><span class="mi">10</span> <span class="ow">and</span>  <span class="n">name</span><span class="o">=</span><span class="n">root</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="æ™®é€šæœç´¢">æ™®é€šæœç´¢
</h4><h4 id="ç»„åˆæœç´¢">ç»„åˆæœç´¢
</h4><h3 id="æƒé™æŒ‰é’®">æƒé™æŒ‰é’®
</h3><p>æ²¡æƒé™å°±ä¸è¦æ˜¾ç¤º</p>
<h4 id="åœ¨æ¨¡æ¿ä¸­è‡ªå®šä¹‰æ–¹æ³•">åœ¨æ¨¡æ¿ä¸­è‡ªå®šä¹‰æ–¹æ³•
</h4><ul>
<li>filter</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="s2">&#34;xxxx&#34;</span><span class="o">|</span><span class="n">upper</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>simple_tag</li>
</ul>
<p>ä¸èƒ½ç”¨ifåšæ¡ä»¶</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="p">{</span><span class="o">%</span> <span class="n">xxxx</span> <span class="n">x1</span> <span class="n">x2</span> <span class="n">x3</span> <span class="o">%</span><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">xxx</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="s2">&#34;&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>inclusion_tag</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">xxx</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="p">{</span><span class="s1">&#39;v1&#39;</span><span class="p">:</span><span class="n">xx</span><span class="p">,</span><span class="s1">&#39;v2&#39;</span><span class="p">:</span><span class="n">xx</span><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="p">{{</span><span class="n">v1</span><span class="p">}}</span><span class="o">&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="åå‘ç”Ÿæˆurl">åå‘ç”ŸæˆURL
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">path</span><span class="p">(</span><span class="s1">&#39;login/&#39;</span><span class="p">,</span> <span class="n">account</span><span class="o">.</span><span class="n">login</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;login&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">reverse</span><span class="p">(</span><span class="s2">&#34;login&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">path</span><span class="p">(</span><span class="s1">&#39;level/edit/&lt;int:pk&gt;/&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">.</span><span class="n">level_edit</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s2">&#34;level_edit&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">reverse</span><span class="p">(</span><span class="s2">&#34;level/edit&#34;</span><span class="p">,</span><span class="n">kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&#34;pk&#34;</span><span class="p">:</span><span class="mi">123</span><span class="p">})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">re_path</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;level/(\d+)/&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">.</span><span class="n">level_edit</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s2">&#34;level&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">reverse</span><span class="p">(</span><span class="s2">&#34;level/edit&#34;</span><span class="p">,</span><span class="n">wargs</span><span class="o">=</span><span class="p">(</span><span class="mi">111</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="å®ç°">å®ç°
</h4><p>æƒé™çš„ç²’åº¦æ§åˆ¶åœ¨æŒ‰é’®ï¼Œæ ¹æ®æ˜¯å¦å…·æœ‰æƒé™æ¥å†³å®šæ˜¯å¦å±•ç¤º å“åº”æŒ‰é’®ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="p">{</span><span class="o">%</span> <span class="n">permission</span> <span class="n">request</span> <span class="s2">&#34;user_add&#34;</span> <span class="n">v1</span><span class="o">=</span><span class="mi">111</span> <span class="n">v2</span><span class="o">=</span><span class="mi">111</span> <span class="o">%</span><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="nd">@register.simple_tag</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">demo</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 1.è¯»å–ç”¨æˆ·è§’è‰²ï¼Œè·å–æƒé™å­—å…¸</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># 2.åˆ¤æ–­æ˜¯å¦æœ‰æƒé™</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># 3.æ— æƒé™ï¼Œè¿”å›ç©º</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># 4.æœ‰æƒé™ï¼Œæ ¹æ®nameç”ŸæˆURL</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="s2">&#34;....&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/post/python/order_trading_platform/1732417614947-651a16d8-3a0e-41dd-af35-d4f3ab9236b9.png"
	
	
	
	loading="lazy"
	
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">ç”Ÿæˆå†…å®¹åˆ†ä¸ºæŒ‰é’®çš„ç”Ÿæˆå’Œè¡¨å•ä¸­tdæ ‡ç­¾çš„ç”Ÿæˆå’Œthæ ‡ç‚¹çš„ç”Ÿæˆ</span>
</span></span><span class="line"><span class="cl"><span class="n">å®¢æˆ·çš„å¢åˆ æ”¹æŸ¥ä¸ä»·æ ¼ç­–ç•¥çš„å·®ä¸å¤š</span><span class="err">ï¼Œ</span><span class="n">åˆ é™¤æ“ä½œéƒ½æ˜¯ç”Ÿæˆä¸€ä¸ªcidåœ¨æ ‡ç­¾é‡Œåç»­é€šè¿‡jså‘é€è‡³åç«¯</span><span class="err">ï¼Œ</span>
</span></span><span class="line"><span class="cl"><span class="n">ä½†çº§åˆ«ç®¡ç†æ˜¯é€šè¿‡url</span><span class="p">:</span><span class="n">level</span><span class="o">/</span><span class="n">delete</span><span class="o">/</span><span class="mi">1</span><span class="n">æ¥æ¥æ”¶pkç„¶åç›´æ¥åˆ é™¤</span><span class="err">ï¼Œ</span><span class="n">æ²¡æœ‰æ¨¡æ€æ¡†ç­‰æ“ä½œ</span><span class="err">ï¼Œ</span><span class="n">å› æ­¤é‡å†™delete_url_permissionæ–¹æ³•</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/post/python/order_trading_platform/1732419352138-59ac7616-92c9-4bf0-bd2c-b807c364e1b8.png"
	
	
	
	loading="lazy"
	
	
></p>
<h3 id="è·³è½¬é“¾æ¥">è·³è½¬é“¾æ¥
</h3><p>åœ¨ç”ŸæˆURLæ—¶ï¼Œéœ€è¦è¯»å–å½“å‰URLä¸­çš„å‚æ•°å¹¶æ„é€ URLã€‚ä¾‹å¦‚ï¼š</p>
<p>å½“å‰URL</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0.0.1</span><span class="p">:</span><span class="mi">8000</span><span class="o">/</span><span class="n">customer</span><span class="o">/</span><span class="nb">list</span><span class="o">/</span><span class="err">?</span><span class="n">keyword</span><span class="o">=</span><span class="n">xinchen</span><span class="o">&amp;</span><span class="n">page</span><span class="o">=</span><span class="mi">8</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ„é€ å½“å‰é¡µé¢URL</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0.0.1</span><span class="p">:</span><span class="mi">8000</span><span class="o">/</span><span class="n">customer</span><span class="o">/</span><span class="n">edit</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="err">?</span><span class="n">_filter</span><span class="o">=</span><span class="n">keyword</span><span class="o">%</span><span class="mi">3</span><span class="n">Dxinchen</span><span class="o">%</span><span class="mi">26</span><span class="n">page</span><span class="o">%</span><span class="mi">3</span><span class="n">D8</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">param</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">urlencode</span><span class="p">()</span> <span class="c1"># keyword=xinchen&amp;page=8</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">new_query_dict</span> <span class="o">=</span> <span class="n">QueryDict</span><span class="p">(</span><span class="n">mutable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">new_query_dict</span><span class="p">[</span><span class="s1">&#39;_filter&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">param</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">new_query_dict</span><span class="o">.</span><span class="n">urlencode</span><span class="p">()</span>  <span class="n">_filter</span><span class="o">=</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è·³è½¬å›æ¥æ—¶</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0.0.1</span><span class="p">:</span><span class="mi">8000</span><span class="o">/</span><span class="n">customer</span><span class="o">/</span><span class="nb">list</span><span class="o">/</span><span class="err">?</span><span class="n">keyword</span><span class="o">=</span><span class="n">xinchen</span><span class="o">&amp;</span><span class="n">page</span><span class="o">=</span><span class="mi">8</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">policy_edit</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">pk</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span><span class="line"><span class="cl">    <span class="n">base_url</span> <span class="o">=</span> <span class="n">reverse</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="n">kwargs</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">param_url</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;_filter&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;</span><span class="si">{}</span><span class="s2">?</span><span class="si">{}</span><span class="s2">&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">base_url</span><span class="p">,</span><span class="n">param_url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/post/python/order_trading_platform/1732420375791-3a55f11f-dbde-49a1-8afb-dc818037c834.png"
	
	
	
	loading="lazy"
	
	
></p>
<h3 id="äº‹åŠ¡">äº‹åŠ¡
</h3><h4 id="ä»‹ç»">ä»‹ç»
</h4><p>innodbå¼•æ“ä¸­æ”¯æŒäº‹åŠ¡ï¼Œmyisamä¸æ”¯æŒ</p>
<p>ä¾‹å¦‚ï¼šA ç»™ B è½¬è´¦ 100ï¼Œé‚£å°±ä¼šæ¶‰åŠ2ä¸ªæ­¥éª¤ã€‚</p>
<ul>
<li>A è´¦æˆ· å‡100</li>
<li>B è´¦æˆ· åŠ  100</li>
</ul>
<p>è¿™ä¸¤ä¸ªæ­¥éª¤å¿…é¡»åŒæ—¶å®Œæˆæ‰ç®—å®Œæˆï¼Œå¹¶ä¸”å¦‚æœç¬¬ä¸€ä¸ªå®Œæˆã€ç¬¬äºŒæ­¥å¤±è´¥ï¼Œè¿˜æ˜¯å›æ»šåˆ°åˆå§‹çŠ¶æ€ã€‚</p>
<p>äº‹åŠ¡ï¼Œå°±æ˜¯æ¥è§£å†³è¿™ç§æƒ…å†µçš„ã€‚  å¤§ç™½è¯ï¼šè¦æˆåŠŸéƒ½æˆåŠŸï¼›è¦å¤±è´¥éƒ½å¤±è´¥ã€‚</p>
<p>äº‹åŠ¡çš„å…·æœ‰å››å¤§ç‰¹æ€§ï¼ˆACIDï¼‰ï¼š</p>
<ul>
<li>åŸå­æ€§ï¼ˆAtomicityï¼‰</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">åŸå­æ€§æ˜¯æŒ‡äº‹åŠ¡åŒ…å«çš„æ‰€æœ‰æ“ä½œä¸å¯åˆ†å‰²</span><span class="err">ï¼Œ</span><span class="n">è¦ä¹ˆå…¨éƒ¨æˆåŠŸ</span><span class="err">ï¼Œ</span><span class="n">è¦ä¹ˆå…¨éƒ¨å¤±è´¥å›æ»š</span><span class="err">ã€‚</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">æ‰§è¡Œçš„å‰åæ•°æ®çš„å®Œæ•´æ€§ä¿æŒä¸€è‡´</span><span class="err">ã€‚</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>éš”ç¦»æ€§ï¼ˆIsolationï¼‰</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">ä¸€ä¸ªäº‹åŠ¡æ‰§è¡Œçš„è¿‡ç¨‹ä¸­</span><span class="p">,</span><span class="n">ä¸åº”è¯¥å—åˆ°å…¶ä»–äº‹åŠ¡çš„å¹²æ‰°</span><span class="err">ã€‚</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>æŒä¹…æ€§ï¼ˆDurabilityï¼‰</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">äº‹åŠ¡ä¸€æ—¦ç»“æŸ</span><span class="p">,</span><span class="n">æ•°æ®å°±æŒä¹…åˆ°æ•°æ®åº“</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="mysqlå®¢æˆ·ç«¯">MySQLå®¢æˆ·ç«¯
</h4><ul>
<li>è®¾ç½®éš”ç¦»çº§åˆ«</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">NSACTION</span> <span class="n">ISOLATION</span> <span class="n">LEVEL</span> <span class="p">[</span><span class="n">éš”ç¦»çº§åˆ«</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">å¸¸è§éš”ç¦»çº§åˆ«</span><span class="err">ï¼š</span>
</span></span><span class="line"><span class="cl">    <span class="n">READ</span> <span class="n">UNCOMMITTED</span><span class="err">ï¼š</span><span class="n">å…è®¸è¯»å–æœªæäº¤çš„æ•°æ®</span><span class="err">ã€‚</span>
</span></span><span class="line"><span class="cl">    <span class="n">READ</span> <span class="n">COMMITTED</span><span class="err">ï¼š</span><span class="n">åªèƒ½è¯»å–å·²æäº¤çš„æ•°æ®</span><span class="err">ã€‚</span>
</span></span><span class="line"><span class="cl">    <span class="n">REPEATABLE</span> <span class="n">READ</span><span class="err">ï¼š</span><span class="n">ç¡®ä¿åœ¨åŒä¸€äº‹åŠ¡ä¸­å¤šæ¬¡è¯»å–åŒæ ·çš„è®°å½•ç»“æœæ˜¯ä¸€è‡´çš„</span><span class="err">ã€‚</span>
</span></span><span class="line"><span class="cl">    <span class="n">SERIALIZABLE</span><span class="err">ï¼š</span><span class="n">æœ€é«˜çš„éš”ç¦»çº§åˆ«</span><span class="err">ï¼Œ</span><span class="n">å®Œå…¨ä¸²è¡ŒåŒ–çš„äº‹åŠ¡</span><span class="err">ã€‚</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>å¼€å§‹äº‹åŠ¡</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">START</span> <span class="n">TRANSACTION</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># BEGIN;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>æ‰§è¡Œæ•°æ®åº“æ“ä½œ</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">åœ¨äº‹åŠ¡ä¸­</span><span class="err">ï¼Œ</span><span class="n">ä½ å¯ä»¥æ‰§è¡Œå¤šä¸ªæ•°æ®åº“æ“ä½œ</span><span class="err">ï¼Œ</span><span class="n">å¦‚INSERT</span><span class="err">ã€</span><span class="n">UPDATE</span><span class="err">ã€</span><span class="n">DELETEç­‰</span><span class="err">ã€‚</span><span class="n">è¿™äº›æ“ä½œå°†è¢«åŒ…å«åœ¨å½“å‰äº‹åŠ¡ä¸­</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>æäº¤æˆ–å›æ»šäº‹åŠ¡</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">æäº¤äº‹åŠ¡</span>
</span></span><span class="line"><span class="cl"><span class="n">COMMIT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">å›æ»šæ‰€æœ‰æ“ä½œ</span>
</span></span><span class="line"><span class="cl"><span class="n">ROLLBACK</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="pythonä»£ç ">Pythonä»£ç 
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pymysql</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">conn</span> <span class="o">=</span> <span class="n">pymysql</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;127.0.0.1&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">3306</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;root&#39;</span><span class="p">,</span> <span class="n">passwd</span><span class="o">=</span><span class="s1">&#39;root123&#39;</span><span class="p">,</span> <span class="n">charset</span><span class="o">=</span><span class="s2">&#34;utf8&#34;</span><span class="p">,</span> <span class="n">db</span><span class="o">=</span><span class="s1">&#39;userdb&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">cursor</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å¼€å¯äº‹åŠ¡</span>
</span></span><span class="line"><span class="cl"><span class="n">conn</span><span class="o">.</span><span class="n">begin</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&#34;update users set amount=1 where id=1&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">int</span><span class="p">(</span><span class="s1">&#39;asdf&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&#34;update tran set amount=2 where id=2&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># å›æ»š</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;å›æ»š&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">conn</span><span class="o">.</span><span class="n">rollback</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># æäº¤</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;æäº¤&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">conn</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">cursor</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="djangoæ“ä½œ">Djangoæ“ä½œ
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">transaction</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="n">transaction</span><span class="o">.</span><span class="n">atomic</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">	<span class="c1"># æ•°æ®åº“æ“ä½œA</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># æ•°æ®åº“æ“ä½œB</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="é”">é”
</h3><h4 id="ä»‹ç»-1">ä»‹ç»
</h4><p>åœ¨ç”¨MySQLæ—¶ï¼Œä¸çŸ¥ä½ æ˜¯å¦ä¼šç–‘é—®ï¼šåŒæ—¶æœ‰å¾ˆå¤šåšæ›´æ–°ã€æ’å…¥ã€åˆ é™¤åŠ¨ä½œï¼ŒMySQLå¦‚ä½•ä¿è¯æ•°æ®ä¸å‡ºé”™å‘¢ï¼Ÿ</p>
<p>MySQLä¸­è‡ªå¸¦äº†é”çš„åŠŸèƒ½ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬å®ç°å¼€å‘è¿‡ç¨‹ä¸­é‡åˆ°çš„åŒæ—¶å¤„ç†æ•°æ®çš„æƒ…å†µã€‚å¯¹äºæ•°æ®åº“ä¸­çš„é”ï¼Œä»é”çš„èŒƒå›´æ¥è®²æœ‰ï¼š</p>
<ul>
<li>è¡¨çº§é”ï¼Œå³Aæ“ä½œè¡¨æ—¶ï¼Œå…¶ä»–äººå¯¹æ•´ä¸ªè¡¨éƒ½ä¸èƒ½æ“ä½œï¼Œç­‰å¾…Aæ“ä½œå®Œä¹‹åï¼Œæ‰èƒ½ç»§ç»­ã€‚</li>
<li>è¡Œçº§é”ï¼Œå³Aæ“ä½œè¡¨æ—¶ï¼Œå…¶ä»–äººå¯¹æŒ‡å®šçš„è¡Œæ•°æ®ä¸èƒ½æ“ä½œï¼Œå…¶ä»–è¡Œå¯ä»¥æ“ä½œï¼Œç­‰å¾…Aæ“ä½œå®Œä¹‹åï¼Œæ‰èƒ½ç»§ç»­ã€‚</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">MYISAMæ”¯æŒè¡¨é”</span><span class="err">ï¼Œ</span><span class="n">ä¸æ”¯æŒè¡Œé”</span><span class="err">ï¼›</span>
</span></span><span class="line"><span class="cl"><span class="n">InnoDBå¼•æ“æ”¯æŒè¡Œé”å’Œè¡¨é”</span><span class="err">ã€‚</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">å³</span><span class="err">ï¼š</span><span class="n">åœ¨MYISAMä¸‹å¦‚æœè¦åŠ é”</span><span class="err">ï¼Œ</span><span class="n">æ— è®ºæ€ä¹ˆåŠ éƒ½ä¼šæ˜¯è¡¨é”</span><span class="err">ã€‚</span>
</span></span><span class="line"><span class="cl">   <span class="n">åœ¨InnoDBå¼•æ“æ”¯æŒä¸‹å¦‚æœæ˜¯åŸºäºç´¢å¼•æŸ¥è¯¢çš„æ•°æ®åˆ™æ˜¯è¡Œçº§é”</span><span class="err">ï¼Œ</span><span class="n">å¦åˆ™å°±æ˜¯è¡¨é”</span><span class="err">ã€‚</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ‰€ä»¥ï¼Œä¸€èˆ¬æƒ…å†µä¸‹æˆ‘ä»¬ä¼šé€‰æ‹©ä½¿ç”¨innodbå¼•æ“ï¼Œå¹¶ä¸”åœ¨ æœç´¢ æ—¶ä¹Ÿä¼šä½¿ç”¨ç´¢å¼•ï¼ˆå‘½ä¸­ç´¢å¼•ï¼‰ã€‚</p>
<p>åœ¨innodbå¼•æ“ä¸­ï¼Œupdateã€insertã€deleteçš„è¡Œä¸ºå†…éƒ¨éƒ½ä¼šå…ˆç”³è¯·é”ï¼ˆæ’å®ƒé”ï¼‰ï¼Œç”³è¯·åˆ°ä¹‹åæ‰æ‰§è¡Œç›¸å…³æ“ä½œï¼Œæœ€åå†é‡Šæ”¾é”ã€‚</p>
<p>æ‰€ä»¥ï¼Œå½“å¤šä¸ªäººåŒæ—¶åƒæ•°æ®åº“æ‰§è¡Œï¼šinsertã€updateã€deleteç­‰æ“ä½œæ—¶ï¼Œå†…éƒ¨åŠ é”åä¼šæ’é˜Ÿé€ä¸€æ‰§è¡Œã€‚</p>
<p>è€Œselectåˆ™é»˜è®¤ä¸ä¼šç”³è¯·é”ã€‚</p>
<p>å¦‚æœï¼Œä½ æƒ³è¦è®©selectå»ç”³è¯·é”ï¼Œåˆ™éœ€è¦é…åˆ äº‹åŠ¡ + ç‰¹æ®Šè¯­æ³•æ¥å®ç°ã€‚</p>
<p><code>for update</code>ï¼Œæ’å®ƒé”ï¼ŒåŠ é”ä¹‹åï¼Œå…¶ä»–ä¸å¯ä»¥è¯»å†™</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">begin</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl">	<span class="n">select</span> <span class="o">*</span> <span class="kn">from</span> <span class="nn">L1</span> <span class="n">where</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;æ­¦æ²›é½&#34;</span> <span class="k">for</span> <span class="n">update</span><span class="p">;</span>    <span class="o">--</span> <span class="n">nameåˆ—ä¸æ˜¯ç´¢å¼•</span><span class="err">ï¼ˆ</span><span class="n">è¡¨é”</span><span class="err">ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="n">commit</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">begin</span><span class="p">;</span> <span class="o">--</span> <span class="n">æˆ–è€…</span> <span class="n">start</span> <span class="n">transaction</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">select</span> <span class="o">*</span> <span class="kn">from</span> <span class="nn">L1</span> <span class="n">where</span> <span class="nb">id</span><span class="o">=</span><span class="mi">1</span> <span class="k">for</span> <span class="n">update</span><span class="p">;</span>			  <span class="o">--</span> <span class="n">idåˆ—æ˜¯ç´¢å¼•</span><span class="err">ï¼ˆ</span><span class="n">è¡Œé”</span><span class="err">ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="n">commit</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>åŸºäºPythonä»£ç ç¤ºä¾‹</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pymysql</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">threading</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">task</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">conn</span> <span class="o">=</span> <span class="n">pymysql</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;127.0.0.1&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">3306</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;root&#39;</span><span class="p">,</span> <span class="n">passwd</span><span class="o">=</span><span class="s1">&#39;root123&#39;</span><span class="p">,</span> <span class="n">charset</span><span class="o">=</span><span class="s2">&#34;utf8&#34;</span><span class="p">,</span> <span class="n">db</span><span class="o">=</span><span class="s1">&#39;userdb&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">cursor</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">(</span><span class="n">pymysql</span><span class="o">.</span><span class="n">cursors</span><span class="o">.</span><span class="n">DictCursor</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># cursor = conn.cursor()</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">    <span class="c1"># å¼€å¯äº‹åŠ¡</span>
</span></span><span class="line"><span class="cl">    <span class="n">conn</span><span class="o">.</span><span class="n">begin</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&#34;select id,age from tran where id=2 for update&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># fetchall      ( {&#34;id&#34;:1,&#34;age&#34;:10},{&#34;id&#34;:2,&#34;age&#34;:10}, )   ((1,10),(2,10))</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># {&#34;id&#34;:1,&#34;age&#34;:10}   (1,10)</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">current_age</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">current_age</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&#34;update tran set age=age-1 where id=2&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;å·²å”®ç½„&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">conn</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">cursor</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">run</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">t</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">task</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">t</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">run</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="messageç»„ä»¶">Messageç»„ä»¶
</h3><p><img src="/post/python/order_trading_platform/1732720463327-c9cff61e-1c73-4592-a43f-b2363cdf865d.png"
	
	
	
	loading="lazy"
	
	
></p>
<h4 id="é…ç½®">é…ç½®
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># MESSAGE_STORAGE = &#39;django.contrib.messages.storage.fallback.FallbackStorage&#39;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># MESSAGE_STORAGE = &#39;django.contrib.messages.storage.cookie.CookieStorage&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">MESSAGE_STORAGE</span> <span class="o">=</span> <span class="s1">&#39;django.contrib.messages.storage.session.SessionStorage&#39;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¦‚å›¾å››ä¸ªä½ç½®</p>
<p><img src="/post/python/order_trading_platform/1732720505524-787489d0-acec-4b44-9f2a-0f284c23571d.png"
	
	
	
	loading="lazy"
	
	
></p>
<h4 id="è¯»å–å€¼">è¯»å–å€¼
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">django.contrib.messages.api</span> <span class="kn">import</span> <span class="n">get_messages</span>
</span></span><span class="line"><span class="cl"><span class="n">messages</span> <span class="o">=</span> <span class="n">get_messages</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">msg</span> <span class="ow">in</span> <span class="n">messages</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">ul</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span><span class="o">%</span> <span class="k">for</span> <span class="n">message</span> <span class="ow">in</span> <span class="n">messages</span> <span class="o">%</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">	    <span class="o">&lt;</span><span class="n">li</span><span class="o">&gt;</span><span class="p">{{</span> <span class="n">message</span><span class="o">.</span><span class="n">tags</span> <span class="p">}}</span> <span class="p">{{</span> <span class="n">message</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">li</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span><span class="o">%</span> <span class="n">endfor</span> <span class="o">%</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="n">ul</span><span class="o">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/post/python/order_trading_platform/1732720567644-3d4b2423-3498-4e03-8101-48bf4dff412d.png"
	
	
	
	loading="lazy"
	
	
></p>
<h4 id="æºç åˆ†æ">æºç åˆ†æ
</h4><p>å‰æˆï¼šmessageæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ˆåŒ…è£¹ï¼‰ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">v1</span> <span class="o">=</span> <span class="s2">&#34;wupeiqi&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">v2</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;æ­¦æ²›é½&#34;</span><span class="p">,</span><span class="mi">123</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Message</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">level</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">extra_tags</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">level</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">level</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="n">message</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">extra_tags</span> <span class="o">=</span> <span class="n">extra_tags</span>
</span></span><span class="line"><span class="cl">		
</span></span><span class="line"><span class="cl"><span class="n">obj</span> <span class="o">=</span> <span class="n">Message</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="s2">&#34;å“ˆå“ˆå“ˆå“ˆ&#34;</span><span class="p">,</span><span class="s2">&#34;123&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">messages</span>
</span></span><span class="line"><span class="cl"><span class="n">messages</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="n">reqeust</span><span class="p">,</span> <span class="n">messages</span><span class="o">.</span><span class="n">ERROR</span><span class="p">,</span> <span class="s2">&#34;åˆ é™¤æˆåŠŸ1&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">messages</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="n">reqeust</span><span class="p">,</span> <span class="n">messages</span><span class="o">.</span><span class="n">SUCCESS</span><span class="p">,</span> <span class="s2">&#34;åˆ é™¤æˆåŠŸ2&#34;</span><span class="p">,</span> <span class="n">extra_tags</span><span class="o">=</span><span class="s2">&#34;å“ˆå“ˆå“ˆ&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/post/python/order_trading_platform/1732720676596-a3032643-a0f7-4073-a3ff-abe7f170a6eb.png"
	
	
	
	loading="lazy"
	
	
></p>
<p><img src="/post/python/order_trading_platform/1732720682764-31163ba5-8c3d-485a-a48d-a78521419e80.png"
	
	
	
	loading="lazy"
	
	
></p>
<ul>
<li>ã€è®¾ç½®ã€‘ä¸­é—´ä»¶process_requeståŠ è½½</li>
<li>ã€è®¾ç½®ã€‘åœ¨è§†å›¾å‡½æ•°ä¸­å¾€messageä¸­å†™å…¥å€¼ï¼ˆå†…å­˜ï¼‰</li>
<li>ã€è®¾ç½®ã€‘ä¸­é—´ä»¶process_responseï¼Œå°†å†…å­˜ä¸­æ–°å¢çš„æ•°æ®å†™å…¥åˆ°æ•°æ®æº</li>
<li>ã€æ–°é¡µé¢ã€‘ä¸­é—´ä»¶process_requeståŠ è½½</li>
<li>ã€æ–°é¡µé¢ã€‘åœ¨è§†å›¾å‡½æ•°æˆ–æ¨¡æ¿ä¸­è¯»å–messageä¸­çš„ä¿¡æ¯ï¼ˆè€çš„æ•°æ®æºåŠ è½½çš„+æ–°å¢çš„ï¼‰</li>
<li>ã€è®¾ç½®ã€‘ä¸­é—´ä»¶process_response</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">used</span> <span class="o">=</span> <span class="kc">True</span><span class="err">ï¼Œ</span><span class="n">åˆ™åªä¿å­˜æ–°å¢éƒ¨åˆ†</span><span class="err">ã€‚</span>
</span></span><span class="line"><span class="cl"><span class="n">added_new</span> <span class="o">=</span> <span class="kc">True</span><span class="err">ï¼Œ</span><span class="n">è€çš„æ•°æ®æºåŠ è½½çš„</span><span class="o">+</span><span class="n">æ–°å¢çš„éƒ½é‡æ–°ä¿å­˜åˆ°æ•°æ®æº</span><span class="err">ã€‚</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æµç¨‹åˆ†æï¼š</p>
<ul>
<li>1.1 process_request</li>
</ul>
<p><img src="/post/python/order_trading_platform/1732720747603-5775175f-9420-481a-90af-d35b154cf25f.png"
	
	
	
	loading="lazy"
	
	
></p>
<p><img src="/post/python/order_trading_platform/1732720752615-2aa212e3-bc17-4946-a4be-4ba5cd7bb10f.png"
	
	
	
	loading="lazy"
	
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">ç»™request</span><span class="o">.</span><span class="n">_messageèµ‹å€¼äº†ä¸€ä¸ªSessionStorageå¯¹è±¡</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>1.2 åˆ é™¤è§†å›¾</li>
</ul>
<p><img src="/post/python/order_trading_platform/1732720777652-624b9187-f46d-4c6e-8cf4-a26680c26721.png"
	
	
	
	loading="lazy"
	
	
></p>
<ul>
<li>1.3 request_response</li>
</ul>
<p><img src="/post/python/order_trading_platform/1732720791532-35f3a55a-352d-4d01-900b-5118d007448d.png"
	
	
	
	loading="lazy"
	
	
></p>
<ul>
<li>2.1 process_request + åˆ—è¡¨è§†å›¾</li>
</ul>
<p><img src="/post/python/order_trading_platform/1732720810924-4c5bbd80-c48a-41ef-a072-c04da375676b.png"
	
	
	
	loading="lazy"
	
	
></p>
<ul>
<li>2.2 request_response</li>
</ul>
<p><img src="/post/python/order_trading_platform/1732720828091-ff87ebff-38e7-4373-9f97-01fd9b82ada5.png"
	
	
	
	loading="lazy"
	
	
></p>
<h3 id="ç»„åˆæœç´¢-1">ç»„åˆæœç´¢
</h3><p>å…·ä½“å®ç°ï¼šç•¥</p>
<h4 id="ä½¿ç”¨">ä½¿ç”¨
</h4><p>åœ¨è§†å›¾å‡½æ•°ä¸­</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">render</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">web</span> <span class="kn">import</span> <span class="n">models</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">utils.pager</span> <span class="kn">import</span> <span class="n">Pagination</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">django.db.models</span> <span class="kn">import</span> <span class="n">Q</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">utils.group</span> <span class="kn">import</span> <span class="n">Option</span><span class="p">,</span> <span class="n">NbSearchGroup</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">my_transaction_list</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;æˆ‘çš„äº¤æ˜“è®°å½•&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># ç¬¬ä¸€æ­¥ï¼šé…ç½®å’Œä¼ å‚</span>
</span></span><span class="line"><span class="cl">    <span class="n">search_group</span> <span class="o">=</span> <span class="n">NbSearchGroup</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">request</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">models</span><span class="o">.</span><span class="n">TransactionRecord</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">Option</span><span class="p">(</span><span class="s1">&#39;charge_type&#39;</span><span class="p">),</span> <span class="c1"># choice</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># ç¬¬äºŒæ­¥ï¼šè·å–æ¡ä»¶</span>
</span></span><span class="line"><span class="cl">    <span class="n">queryset</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TransactionRecord</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="o">**</span><span class="n">search_group</span><span class="o">.</span><span class="n">get_condition</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">pager</span> <span class="o">=</span> <span class="n">Pagination</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">queryset</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># ç¬¬ä¸‰æ­¥ï¼šä¼ å…¥å‰ç«¯é¡µé¢</span>
</span></span><span class="line"><span class="cl">    <span class="n">context</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;pager&#34;</span><span class="p">:</span> <span class="n">pager</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;keyword&#34;</span><span class="p">:</span> <span class="n">keyword</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;search_group_row_list&#34;</span><span class="p">:</span> <span class="n">search_group</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s2">&#34;my_transaction_list.html&#34;</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">#æ¯ç‰ˆ</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">link</span> <span class="n">rel</span><span class="o">=</span><span class="s2">&#34;stylesheet&#34;</span> <span class="n">href</span><span class="o">=</span><span class="s2">&#34;{</span><span class="si">% s</span><span class="s2">tatic &#39;css/search-group.css&#39; %}&#34;</span><span class="o">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ¨¡æ¿</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="p">{</span><span class="o">%</span> <span class="n">block</span> <span class="n">content</span> <span class="o">%</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span><span class="o">%</span> <span class="n">include</span> <span class="s1">&#39;include/search_group.html&#39;</span> <span class="o">%</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="o">%</span> <span class="n">endblock</span> <span class="o">%</span><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="æ‚">æ‚
</h3><h4 id="åœ¨å…¨å±€å˜é‡ä¸­å®šä¹‰è‡ªå·±çš„ä¸“å±é…ç½®">åœ¨å…¨å±€å˜é‡ä¸­å®šä¹‰è‡ªå·±çš„ä¸“å±é…ç½®
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">django.conf</span> <span class="kn">import</span> <span class="n">settings</span>
</span></span><span class="line"><span class="cl"><span class="n">åœ¨settingsæ–‡ä»¶ä¸­å®šä¹‰ä¸“å±é…ç½®</span><span class="err">ï¼ˆ</span><span class="n">åç§°å¿…é¡»å¤§å†™</span><span class="err">ï¼‰</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="é¢å‘å¯¹è±¡å°çŸ¥è¯†">é¢å‘å¯¹è±¡å°çŸ¥è¯†
</h4><h5 id="superå…³é”®å­—-1">superå…³é”®å­—
</h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">superæ˜¯æ‰¾çˆ¶ç±»ä¸­çš„æˆå‘˜å—</span><span class="err">ï¼Ÿ</span><span class="n">ä¸å‡†ç¡®</span><span class="err">ã€‚</span>
</span></span><span class="line"><span class="cl"><span class="nb">super</span><span class="p">,</span><span class="n">å°±æ˜¯æ ¹æ®ç±»çš„ç»§æ‰¿å…³ç³»</span><span class="err">ï¼ˆ</span><span class="n">mro</span><span class="err">ï¼‰ï¼Œ</span><span class="n">é€æ­¥æ™šä¸Šæ‰¾</span><span class="err">ã€‚</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Base</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">f1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Base&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Foo</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">	<span class="k">pass</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Bar</span><span class="p">(</span><span class="n">Foo</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">f1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Bar&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">f1</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">obj</span> <span class="o">=</span> <span class="n">Bar</span><span class="p">()</span>  <span class="c1"># [Bar,Foo,Base]</span>
</span></span><span class="line"><span class="cl"><span class="n">obj</span><span class="o">.</span><span class="n">f1</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Bar Base</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Base</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">f1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Base&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Foo</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">f1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Foo&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">f1</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Bar</span><span class="p">(</span><span class="n">Foo</span><span class="p">,</span><span class="n">Base</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">f1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Bar&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">f1</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl"><span class="n">obj</span> <span class="o">=</span> <span class="n">Bar</span><span class="p">()</span>  <span class="c1"># [Bar,Foo,Base]</span>
</span></span><span class="line"><span class="cl"><span class="n">obj</span><span class="o">.</span><span class="n">f1</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Bar Foo Base</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Base</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">f1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Base&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Foo</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">f1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Foo&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">f1</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Bar</span><span class="p">(</span><span class="n">Foo</span><span class="p">,</span><span class="n">Base</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">f1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Bar&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">f1</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl"><span class="n">obj</span> <span class="o">=</span> <span class="n">Foo</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">obj</span><span class="o">.</span><span class="n">f1</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Foo</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="é¡¹ç›®">é¡¹ç›®
</h2><p><strong>åˆå§‹åŒ–åŸºæœ¬æµç¨‹ï¼š</strong></p>
<ul>
<li>æ–°å»ºé¡¹ç›®ã€è™šæ‹Ÿç¯å¢ƒã€pipã€projectã€app</li>
<li>æ–°å»ºæ•°æ®åº“ã€é…ç½®æ•°æ®åº“è¿æ¥ã€ç²¾ç®€åŒ–django</li>
<li>åˆ›å»ºè¡¨ç»“æ„ï¼ˆæ³¨å†Œappã€æ³¨é‡Šadminï¼‰</li>
</ul>
<p><strong>urls.pyè·¯ç”±é…ç½®ï¼š</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># from django.contrib import admin</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">path</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">web.views</span> <span class="kn">import</span> <span class="n">account</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">web.views</span> <span class="kn">import</span> <span class="n">level</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">web.views</span> <span class="kn">import</span> <span class="n">customer</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">web.views</span> <span class="kn">import</span> <span class="n">policy</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">web.views</span> <span class="kn">import</span> <span class="n">my_order</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">web.views</span> <span class="kn">import</span> <span class="n">my_transaction</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># path(&#39;admin/&#39;, admin.site.urls),</span>
</span></span><span class="line"><span class="cl">    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;login/&#39;</span><span class="p">,</span> <span class="n">account</span><span class="o">.</span><span class="n">login</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;login&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;sms/login/&#39;</span><span class="p">,</span> <span class="n">account</span><span class="o">.</span><span class="n">sms_login</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;sms_login&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;sms/send/&#39;</span><span class="p">,</span> <span class="n">account</span><span class="o">.</span><span class="n">sms_send</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;sms_send&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;logout/&#39;</span><span class="p">,</span> <span class="n">account</span><span class="o">.</span><span class="n">logout</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;logout&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;home/&#39;</span><span class="p">,</span> <span class="n">account</span><span class="o">.</span><span class="n">home</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;home&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;level/list/&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">.</span><span class="n">level_list</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;level_list&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;level/add/&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">.</span><span class="n">level_add</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;level_add&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;level/edit/&lt;int:pk&gt;/&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">.</span><span class="n">level_edit</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;level_edit&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;level/delete/&lt;int:pk&gt;/&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">.</span><span class="n">level_delete</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;level_delete&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;customer/list/&#39;</span><span class="p">,</span> <span class="n">customer</span><span class="o">.</span><span class="n">customer_list</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;customer_list&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;customer/add/&#39;</span><span class="p">,</span> <span class="n">customer</span><span class="o">.</span><span class="n">customer_add</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;customer_add&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;customer/edit/&lt;int:pk&gt;/&#39;</span><span class="p">,</span> <span class="n">customer</span><span class="o">.</span><span class="n">customer_edit</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;customer_edit&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;customer/reset/&lt;int:pk&gt;/&#39;</span><span class="p">,</span> <span class="n">customer</span><span class="o">.</span><span class="n">customer_reset</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;customer_reset&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;customer/delete/&#39;</span><span class="p">,</span> <span class="n">customer</span><span class="o">.</span><span class="n">customer_delete</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;customer_delete&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;customer/charge/&lt;int:pk&gt;/&#39;</span><span class="p">,</span> <span class="n">customer</span><span class="o">.</span><span class="n">customer_charge</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;customer_charge&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;customer/charge/&lt;int:pk&gt;/add&#39;</span><span class="p">,</span> <span class="n">customer</span><span class="o">.</span><span class="n">customer_charge_add</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;customer_charge_add&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;policy/list/&#39;</span><span class="p">,</span> <span class="n">policy</span><span class="o">.</span><span class="n">policy_list</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;policy_list&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;policy/add/&#39;</span><span class="p">,</span> <span class="n">policy</span><span class="o">.</span><span class="n">policy_add</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;policy_add&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;policy/edit/&lt;int:pk&gt;/&#39;</span><span class="p">,</span> <span class="n">policy</span><span class="o">.</span><span class="n">policy_edit</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;policy_edit&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;policy/delete/&#39;</span><span class="p">,</span> <span class="n">policy</span><span class="o">.</span><span class="n">policy_delete</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;policy_delete&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;my/order/list/&#39;</span><span class="p">,</span> <span class="n">my_order</span><span class="o">.</span><span class="n">my_order_list</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;my_order_list&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;my/order/add/&#39;</span><span class="p">,</span> <span class="n">my_order</span><span class="o">.</span><span class="n">my_order_add</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;my_order_add&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;my/order/cancel/&lt;int:pk&gt;/&#39;</span><span class="p">,</span> <span class="n">my_order</span><span class="o">.</span><span class="n">my_order_cancel</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;my_order_cancel&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;my/transaction/list/&#39;</span><span class="p">,</span> <span class="n">my_transaction</span><span class="o">.</span><span class="n">my_transaction_list</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;my_transaction_list&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;transaction/list/&#39;</span><span class="p">,</span> <span class="n">my_transaction</span><span class="o">.</span><span class="n">transaction_list</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;transaction_list&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>settings.pyé…ç½®ï¼š</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span><span class="lnt">205
</span><span class="lnt">206
</span><span class="lnt">207
</span><span class="lnt">208
</span><span class="lnt">209
</span><span class="lnt">210
</span><span class="lnt">211
</span><span class="lnt">212
</span><span class="lnt">213
</span><span class="lnt">214
</span><span class="lnt">215
</span><span class="lnt">216
</span><span class="lnt">217
</span><span class="lnt">218
</span><span class="lnt">219
</span><span class="lnt">220
</span><span class="lnt">221
</span><span class="lnt">222
</span><span class="lnt">223
</span><span class="lnt">224
</span><span class="lnt">225
</span><span class="lnt">226
</span><span class="lnt">227
</span><span class="lnt">228
</span><span class="lnt">229
</span><span class="lnt">230
</span><span class="lnt">231
</span><span class="lnt">232
</span><span class="lnt">233
</span><span class="lnt">234
</span><span class="lnt">235
</span><span class="lnt">236
</span><span class="lnt">237
</span><span class="lnt">238
</span><span class="lnt">239
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Build paths inside the project like this: BASE_DIR / &#39;subdir&#39;.</span>
</span></span><span class="line"><span class="cl"><span class="n">BASE_DIR</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Quick-start development settings - unsuitable for production</span>
</span></span><span class="line"><span class="cl"><span class="c1"># See https://docs.djangoproject.com/en/3.2/howto/deployment/checklist/</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># SECURITY WARNING: keep the secret key used in production secret!</span>
</span></span><span class="line"><span class="cl"><span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s1">&#39;django-insecure-9pt%1b</span><span class="si">%f</span><span class="s1">2*&amp;*)ipcfmzec&amp;69r(e(q#(2m-$yx1m85g-4-pi%wz&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># SECURITY WARNING: don&#39;t run with debug turned on in production!</span>
</span></span><span class="line"><span class="cl"><span class="n">DEBUG</span> <span class="o">=</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ALLOWED_HOSTS</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Application definition</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">INSTALLED_APPS</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># &#39;django.contrib.admin&#39;,</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># &#39;django.contrib.auth&#39;,</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># &#39;django.contrib.contenttypes&#39;,</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># &#39;django.contrib.sessions&#39;,</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;django.contrib.messages&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;django.contrib.staticfiles&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;web.apps.WebConfig&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">MIDDLEWARE</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># &#39;django.middleware.security.SecurityMiddleware&#39;,</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;django.contrib.sessions.middleware.SessionMiddleware&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;django.middleware.common.CommonMiddleware&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;django.middleware.csrf.CsrfViewMiddleware&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># &#39;django.contrib.auth.middleware.AuthenticationMiddleware&#39;,</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;django.contrib.messages.middleware.MessageMiddleware&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;django.middleware.clickjacking.XFrameOptionsMiddleware&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;utils.md.AuthMiddleware&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ROOT_URLCONF</span> <span class="o">=</span> <span class="s1">&#39;day06.urls&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">TEMPLATES</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;BACKEND&#39;</span><span class="p">:</span> <span class="s1">&#39;django.template.backends.django.DjangoTemplates&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;DIRS&#39;</span><span class="p">:</span> <span class="p">[],</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;APP_DIRS&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;OPTIONS&#39;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;context_processors&#39;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="s1">&#39;django.template.context_processors.debug&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s1">&#39;django.template.context_processors.request&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="c1"># &#39;django.contrib.auth.context_processors.auth&#39;,</span>
</span></span><span class="line"><span class="cl">                <span class="s1">&#39;django.contrib.messages.context_processors.messages&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">WSGI_APPLICATION</span> <span class="o">=</span> <span class="s1">&#39;day06.wsgi.application&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Database</span>
</span></span><span class="line"><span class="cl"><span class="c1"># https://docs.djangoproject.com/en/3.2/ref/settings/#databases</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">DATABASES</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Password validation</span>
</span></span><span class="line"><span class="cl"><span class="c1"># https://docs.djangoproject.com/en/3.2/ref/settings/#auth-password-validators</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">AUTH_PASSWORD_VALIDATORS</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;NAME&#39;</span><span class="p">:</span> <span class="s1">&#39;django.contrib.auth.password_validation.UserAttributeSimilarityValidator&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;NAME&#39;</span><span class="p">:</span> <span class="s1">&#39;django.contrib.auth.password_validation.MinimumLengthValidator&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;NAME&#39;</span><span class="p">:</span> <span class="s1">&#39;django.contrib.auth.password_validation.CommonPasswordValidator&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;NAME&#39;</span><span class="p">:</span> <span class="s1">&#39;django.contrib.auth.password_validation.NumericPasswordValidator&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Internationalization</span>
</span></span><span class="line"><span class="cl"><span class="c1"># https://docs.djangoproject.com/en/3.2/topics/i18n/</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># LANGUAGE_CODE = &#39;en-us&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">LANGUAGE_CODE</span> <span class="o">=</span> <span class="s1">&#39;zh-hans&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">TIME_ZONE</span> <span class="o">=</span> <span class="s1">&#39;UTC&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">USE_I18N</span> <span class="o">=</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">USE_L10N</span> <span class="o">=</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">USE_TZ</span> <span class="o">=</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Static files (CSS, JavaScript, Images)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># https://docs.djangoproject.com/en/3.2/howto/static-files/</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">STATIC_URL</span> <span class="o">=</span> <span class="s1">&#39;/static/&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Default primary key field type</span>
</span></span><span class="line"><span class="cl"><span class="c1"># https://docs.djangoproject.com/en/3.2/ref/settings/#default-auto-field</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">DEFAULT_AUTO_FIELD</span> <span class="o">=</span> <span class="s1">&#39;django.db.models.BigAutoField&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">MENU</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;ADMIN&#34;</span><span class="p">:</span> <span class="p">[],</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;CUSTOMER&#34;</span><span class="p">:</span> <span class="p">[],</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">PERMISSION</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;ADMIN&#34;</span><span class="p">:</span> <span class="p">[],</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;CUSTOMER&#34;</span><span class="p">:</span> <span class="p">[],</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># cacheç¼“å­˜é…ç½®</span>
</span></span><span class="line"><span class="cl"><span class="n">CACHES</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># sessioné…ç½®</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">SESSION_ENGINE</span> <span class="o">=</span> <span class="s1">&#39;django.contrib.sessions.backends.cache&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">SESSION_CACHE_ALIAS</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># è‡ªå®šä¹‰cookieè¿‡æœŸæ—¶é—´</span>
</span></span><span class="line"><span class="cl"><span class="n">SESSION_COOKIE_AGE</span> <span class="o">=</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">24</span> <span class="o">*</span> <span class="mi">7</span> <span class="o">*</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#   è‡ªå®šä¹‰é…ç½®</span>
</span></span><span class="line"><span class="cl"><span class="n">LOGIN_HOME</span> <span class="o">=</span> <span class="s2">&#34;/home/&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">MY_SESSION_KEY</span> <span class="o">=</span> <span class="s2">&#34;user_info&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">MY_LOGIN_URL</span> <span class="o">=</span> <span class="s2">&#34;/login/&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">MY_WHITE_URL</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;/login/&#34;</span><span class="p">,</span> <span class="s2">&#34;/sms/login/&#34;</span><span class="p">,</span> <span class="s2">&#34;/sms/send/&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">MY_MENU</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;ADMIN&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="s2">&#34;ç”¨æˆ·ä¿¡æ¯&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;icon&#39;</span><span class="p">:</span> <span class="s2">&#34;fa-bed&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;children&#39;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span><span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="s2">&#34;çº§åˆ«ç®¡ç†&#34;</span><span class="p">,</span> <span class="s1">&#39;url&#39;</span><span class="p">:</span> <span class="s2">&#34;/level/list&#34;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s2">&#34;level_list&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span><span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="s2">&#34;å®¢æˆ·ç®¡ç†&#34;</span><span class="p">,</span> <span class="s1">&#39;url&#39;</span><span class="p">:</span> <span class="s2">&#34;/customer/list&#34;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s2">&#34;customer_list&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span><span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="s2">&#34;ä»·æ ¼ç­–ç•¥&#34;</span><span class="p">,</span> <span class="s1">&#39;url&#39;</span><span class="p">:</span> <span class="s2">&#34;/policy/list&#34;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s2">&#34;policy_list&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="s2">&#34;äº¤æ˜“ç®¡ç†&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;icon&#39;</span><span class="p">:</span> <span class="s2">&#34;fa-bed&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;children&#39;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span><span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="s2">&#34;äº¤æ˜“è®°å½•&#34;</span><span class="p">,</span> <span class="s1">&#39;url&#39;</span><span class="p">:</span> <span class="s2">&#34;/transaction/list/&#34;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s2">&#34;transaction_list&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;CUSTOMER&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="s2">&#34;ç”¨æˆ·ä¿¡æ¯&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;icon&#39;</span><span class="p">:</span> <span class="s2">&#34;fa-keyboard-o&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;children&#39;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span><span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="s2">&#34;è®¢å•ç®¡ç†&#34;</span><span class="p">,</span> <span class="s1">&#39;url&#39;</span><span class="p">:</span> <span class="s2">&#34;/my/order/list&#34;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s2">&#34;my_order_list&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span><span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="s2">&#34;æˆ‘çš„äº¤æ˜“è®°å½•&#34;</span><span class="p">,</span> <span class="s1">&#39;url&#39;</span><span class="p">:</span> <span class="s2">&#34;/my/transaction/list/&#34;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s2">&#34;my_transaction_list&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">MY_PPERMISSION_PUBLIC</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;home&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;text&#34;</span><span class="p">:</span> <span class="s2">&#34;ä¸»é¡µ&#34;</span><span class="p">,</span> <span class="s2">&#34;parent&#34;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;logout&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;text&#34;</span><span class="p">:</span> <span class="s2">&#34;æ³¨é”€&#34;</span><span class="p">,</span> <span class="s2">&#34;parent&#34;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">MY_PERMISSION</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;ADMIN&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;level_list&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;text&#34;</span><span class="p">:</span> <span class="s2">&#34;çº§åˆ«åˆ—è¡¨&#34;</span><span class="p">,</span> <span class="s2">&#34;parent&#34;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;level_add&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;text&#34;</span><span class="p">:</span> <span class="s2">&#34;æ–°å»ºçº§åˆ«&#34;</span><span class="p">,</span> <span class="s2">&#34;parent&#34;</span><span class="p">:</span> <span class="s1">&#39;level_list&#39;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;level_edit&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;text&#34;</span><span class="p">:</span> <span class="s2">&#34;ç¼–è¾‘çº§åˆ«&#34;</span><span class="p">,</span> <span class="s2">&#34;parent&#34;</span><span class="p">:</span> <span class="s1">&#39;level_list&#39;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;level_delete&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;text&#34;</span><span class="p">:</span> <span class="s2">&#34;åˆ é™¤çº§åˆ«&#34;</span><span class="p">,</span> <span class="s2">&#34;parent&#34;</span><span class="p">:</span> <span class="s1">&#39;level_list&#39;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;customer_list&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;text&#34;</span><span class="p">:</span> <span class="s2">&#34;å®¢æˆ·åˆ—è¡¨&#34;</span><span class="p">,</span> <span class="s2">&#34;parent&#34;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;customer_add&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;text&#34;</span><span class="p">:</span> <span class="s2">&#34;æ–°å»ºå®¢æˆ·&#34;</span><span class="p">,</span> <span class="s2">&#34;parent&#34;</span><span class="p">:</span> <span class="s1">&#39;customer_list&#39;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;customer_edit&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;text&#34;</span><span class="p">:</span> <span class="s2">&#34;ç¼–è¾‘å®¢æˆ·&#34;</span><span class="p">,</span> <span class="s2">&#34;parent&#34;</span><span class="p">:</span> <span class="s1">&#39;customer_list&#39;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;customer_reset&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;text&#34;</span><span class="p">:</span> <span class="s2">&#34;é‡ç½®å¯†ç &#34;</span><span class="p">,</span> <span class="s2">&#34;parent&#34;</span><span class="p">:</span> <span class="s1">&#39;customer_list&#39;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;customer_delete&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;text&#34;</span><span class="p">:</span> <span class="s2">&#34;åˆ é™¤å®¢æˆ·&#34;</span><span class="p">,</span> <span class="s2">&#34;parent&#34;</span><span class="p">:</span> <span class="s1">&#39;customer_list&#39;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;customer_charge&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;text&#34;</span><span class="p">:</span> <span class="s2">&#34;æˆ‘çš„äº¤æ˜“è®°å½•&#34;</span><span class="p">,</span> <span class="s2">&#34;parent&#34;</span><span class="p">:</span> <span class="s1">&#39;customer_list&#39;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;customer_charge_add&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;text&#34;</span><span class="p">:</span> <span class="s2">&#34;åˆ›å»ºäº¤æ˜“è®°å½•&#34;</span><span class="p">,</span> <span class="s2">&#34;parent&#34;</span><span class="p">:</span> <span class="s1">&#39;customer_list&#39;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;policy_list&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;text&#34;</span><span class="p">:</span> <span class="s2">&#34;ä»·æ ¼ç­–ç•¥&#34;</span><span class="p">,</span> <span class="s2">&#34;parent&#34;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;policy_add&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;text&#34;</span><span class="p">:</span> <span class="s2">&#34;åˆ›å»ºä»·æ ¼ç­–ç•¥&#34;</span><span class="p">,</span> <span class="s2">&#34;parent&#34;</span><span class="p">:</span> <span class="s1">&#39;policy_list&#39;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;policy_edit&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;text&#34;</span><span class="p">:</span> <span class="s2">&#34;ç¼–è¾‘ä»·æ ¼ç­–ç•¥&#34;</span><span class="p">,</span> <span class="s2">&#34;parent&#34;</span><span class="p">:</span> <span class="s1">&#39;policy_list&#39;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;policy_delete&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;text&#34;</span><span class="p">:</span> <span class="s2">&#34;åˆ é™¤ä»·æ ¼ç­–ç•¥&#34;</span><span class="p">,</span> <span class="s2">&#34;parent&#34;</span><span class="p">:</span> <span class="s1">&#39;policy_list&#39;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;transaction_list&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;text&#34;</span><span class="p">:</span> <span class="s2">&#34;äº¤æ˜“è®°å½•&#34;</span><span class="p">,</span> <span class="s2">&#34;parent&#34;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;CUSTOMER&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;my_order_list&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;text&#34;</span><span class="p">:</span> <span class="s2">&#34;è®¢å•åˆ—è¡¨&#34;</span><span class="p">,</span> <span class="s2">&#34;parent&#34;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;my_order_add&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;text&#34;</span><span class="p">:</span> <span class="s2">&#34;æ–°å»ºè®¢å•&#34;</span><span class="p">,</span> <span class="s2">&#34;parent&#34;</span><span class="p">:</span> <span class="s1">&#39;my_order_list&#39;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;my_order_cancel&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;text&#34;</span><span class="p">:</span> <span class="s2">&#34;è®¢å•&#34;</span><span class="p">,</span> <span class="s2">&#34;parent&#34;</span><span class="p">:</span> <span class="s1">&#39;my_order_list&#39;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;my_transaction_list&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;text&#34;</span><span class="p">:</span> <span class="s2">&#34;æˆ‘çš„äº¤æ˜“è®°å½•&#34;</span><span class="p">,</span> <span class="s2">&#34;parent&#34;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">QUEUE_TASK_NAME</span> <span class="o">=</span> <span class="s2">&#34;YANG_TASK_QUEUE&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># MESSAGE_STORAGE = &#39;django.contrib.messages.storage.fallback.FallbackStorage&#39;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># MESSAGE_STORAGE = &#39;django.contrib.messages.storage.cookie.CookieStorage&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">MESSAGE_STORAGE</span> <span class="o">=</span> <span class="s1">&#39;django.contrib.messages.storage.session.SessionStorage&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">MESSAGE_DANGER_TAG</span> <span class="o">=</span> <span class="mi">50</span>
</span></span><span class="line"><span class="cl"><span class="n">MESSAGE_TAGS</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">MESSAGE_DANGER_TAG</span><span class="p">:</span> <span class="s2">&#34;danger&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">LOGGING</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;disable_existing_loggers&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;handlers&#39;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;file&#39;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="s1">&#39;ERROR&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;logging.FileHandler&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;filename&#39;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">BASE_DIR</span><span class="p">,</span> <span class="s1">&#39;django_error.log&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;loggers&#39;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;django&#39;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;handlers&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="s1">&#39;ERROR&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;propagate&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="kn">from</span> <span class="nn">.local_settings</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">pass</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>local_settings.pyé…ç½®</strong>ï¼š</p>
<blockquote>
<p>æ”¾ç½®æ•°æ®åº“è¿æ¥é…ç½®ç­‰çº¿ä¸Šä¸æœ¬åœ°æµ‹è¯•ç¯å¢ƒä¸åŒçš„è®¾ç½®</p></blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">DATABASES</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;ENGINE&#39;</span><span class="p">:</span> <span class="s1">&#39;django.db.backends.mysql&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;NAME&#39;</span><span class="p">:</span> <span class="s1">&#39;day06&#39;</span><span class="p">,</span>  <span class="c1"># æ•°æ®åº“åå­—</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;USER&#39;</span><span class="p">:</span> <span class="s1">&#39;root&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;PASSWORD&#39;</span><span class="p">:</span> <span class="s1">&#39;Qiuwj1029&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;HOST&#39;</span><span class="p">:</span> <span class="s1">&#39;127.0.0.1&#39;</span><span class="p">,</span>  <span class="c1"># ip</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;PORT&#39;</span><span class="p">:</span> <span class="mi">3306</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># cacheç¼“å­˜é…ç½®</span>
</span></span><span class="line"><span class="cl"><span class="n">CACHES</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;default&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;BACKEND&#34;</span><span class="p">:</span> <span class="s2">&#34;django_redis.cache.RedisCache&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;LOCATION&#34;</span><span class="p">:</span> <span class="s2">&#34;redis://127.0.0.1:6379&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;OPTIONS&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;CLIENT_CLASS&#34;</span><span class="p">:</span> <span class="s2">&#34;django_redis.client.DefaultClient&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;CONNECTION_POOL_KWARGS&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;max_connections&#34;</span><span class="p">:</span> <span class="mi">100</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># &#34;PASSWORD&#34;: &#34;å¯†ç &#34;,</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ç”¨æˆ·è®¤è¯ç›¸å…³">ç”¨æˆ·è®¤è¯ç›¸å…³
</h3><h4 id="ç”¨æˆ·åå¯†ç ç™»å½•">ç”¨æˆ·åå¯†ç ç™»å½•
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">formä¸­å„ä¸ªå­—æ®µæ”¾ç½®çš„ä½ç½®</span>
</span></span><span class="line"><span class="cl"><span class="n">formè‡ªå®šä¹‰å­—æ®µä¸­placeholder</span>
</span></span><span class="line"><span class="cl"><span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s2">&#34;ç”¨æˆ·åæ ¼å¼é”™è¯¯&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">è§†å›¾å‡½æ•°ä¸­ä¸ºæŒ‡å®šå­—æ®µæ·»åŠ æŠ¥é”™ä¿¡æ¯</span> <span class="n">form</span><span class="o">.</span><span class="n">add_error</span><span class="p">(</span><span class="s2">&#34;username&#34;</span><span class="p">,</span> <span class="s2">&#34;ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>è®¿é—®<code>/login/</code></li>
<li>æ¥åˆ°<code>account.pyä¸‹çš„login()è§†å›¾å‡½æ•°</code></li>
</ul>
<p><img src="/post/python/order_trading_platform/1732500920107-dd72d923-0813-43c5-9cc2-cbc1851acf06.png"
	
	
	
	loading="lazy"
	
	
></p>
<ul>
<li>ç”¨æˆ·çœ‹åˆ°login.htmlå¡«å†™è¡¨å•å¹¶æäº¤ï¼Œå›åˆ°<code>account.pyä¸‹çš„login()è§†å›¾å‡½æ•°</code></li>
</ul>
<p><img src="/post/python/order_trading_platform/1732501766273-5e19ada5-1989-4867-b1db-5b2389279505.png"
	
	
	
	loading="lazy"
	
	
></p>
<p><img src="/post/python/order_trading_platform/1732501497237-59a80514-8caa-4035-984d-d8386fab982a.png"
	
	
	
	loading="lazy"
	
	
></p>
<h4 id="æ‰‹æœºéªŒè¯ç ç™»å½•">æ‰‹æœºéªŒè¯ç ç™»å½•
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">æ¨¡æ¿ä¸­åˆ©ç”¨nameåå‘ç”Ÿæˆurl</span> <span class="p">{</span><span class="o">%</span> <span class="n">url</span> <span class="s1">&#39;login&#39;</span> <span class="o">%</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">formä¸­labelå±æ€§</span>
</span></span><span class="line"><span class="cl"><span class="n">jsonè¿”å›å€¼å¯¹è±¡</span>
</span></span><span class="line"><span class="cl"><span class="n">å‘é€éªŒè¯ç åŠå¯¹åº”é¡µé¢æ•ˆæœå®ç°çš„js</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>ç‚¹å‡»çŸ­ä¿¡ç™»é™†è¿›è¡Œè·³è½¬</li>
</ul>
<p><img src="/post/python/order_trading_platform/1732501594477-80367c51-4524-4f77-bf0f-fae47c252c31.png"
	
	
	
	loading="lazy"
	
	
></p>
<p><img src="/post/python/order_trading_platform/1732501621069-6f7e6a6c-bd40-4b07-a3ee-ee4b805e5cae.png"
	
	
	
	loading="lazy"
	
	
></p>
<ul>
<li>ç”¨æˆ·çœ‹åˆ°sms_login.html</li>
</ul>
<p><img src="/post/python/order_trading_platform/1732502286562-c6bb7e54-0678-4fc8-8bb5-7995c3bef201.png"
	
	
	
	loading="lazy"
	
	
></p>
<ul>
<li>å‘é€éªŒè¯ç å‰ç½®</li>
</ul>
<p><img src="/post/python/order_trading_platform/1732502965263-ae771897-7ce1-4d95-9db7-0e1d24fc6218.png"
	
	
	
	loading="lazy"
	
	
></p>
<ul>
<li>å‘é€éªŒè¯ç </li>
</ul>
<p><img src="/post/python/order_trading_platform/1732503252223-95871ea5-ce14-4d93-b339-4200302cf554.png"
	
	
	
	loading="lazy"
	
	
></p>
<ul>
<li>ç™»å½•æˆåŠŸ</li>
</ul>
<p><img src="/post/python/order_trading_platform/1732503341745-241794bd-3215-4d53-bd86-88cff7951f3d.png"
	
	
	
	loading="lazy"
	
	
></p>
<h3 id="èœå•å’Œæƒé™">èœå•å’Œæƒé™
</h3><h4 id="è®¿é—®æƒé™">è®¿é—®æƒé™
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">process_request</span><span class="err">ï¼Œ</span><span class="n">åŸºäºä»–å®ç°ç”¨æˆ·æ˜¯å¦å·²ç™»å½•</span><span class="err">ï¼Œ</span><span class="n">ç»§ç»­</span><span class="err">ï¼›</span><span class="n">æœªç™»å½•åˆ™è¿”å›ç™»å½•ç•Œé¢</span><span class="err">ã€‚</span>
</span></span><span class="line"><span class="cl">	<span class="o">-</span> <span class="k">return</span> <span class="kc">None</span><span class="err">ï¼Œ</span><span class="n">ç»§ç»­å‘åè®¿é—®</span>
</span></span><span class="line"><span class="cl">	<span class="o">-</span> <span class="k">return</span> <span class="n">å¯¹è±¡</span><span class="err">ï¼Œ</span><span class="n">ç›´æ¥è¿”å›</span><span class="err">ã€‚</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl"><span class="n">process_view</span><span class="err">ï¼Œ</span><span class="n">æƒé™æ ¡éªŒ</span>
</span></span><span class="line"><span class="cl">	<span class="o">-</span> <span class="k">return</span> <span class="kc">None</span><span class="err">ï¼Œ</span><span class="n">ç»§ç»­å‘åè®¿é—®</span>
</span></span><span class="line"><span class="cl">	<span class="o">-</span> <span class="k">return</span> <span class="n">å¯¹è±¡</span><span class="err">ï¼Œ</span><span class="n">ç›´æ¥è¿”å›</span><span class="err">ã€‚</span>
</span></span><span class="line"><span class="cl">	<span class="o">-</span> <span class="n">åœ¨ä»–çš„requestå¯¹è±¡ä¸­æœ‰</span> <span class="n">resolver_match</span>  <span class="err">ï¼Œ</span><span class="n">åŒ…å«å½“å‰è¯·æ±‚çš„è§†å›¾è·¯ç”±ä¿¡æ¯</span>  <span class="o">.</span><span class="n">name</span><span class="o">-&gt;</span><span class="n">sms_login</span>
</span></span><span class="line"><span class="cl">		<span class="n">admin</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sms_login&#39;</span><span class="p">,</span><span class="s2">&#34;xxx&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl"><span class="n">process_response</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>æ˜¯å¦å·²ç™»å½•</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">requestä¸­å–å‡ºè®¿é—®è·¯å¾„</span> <span class="n">request</span><span class="o">.</span><span class="n">path_info</span>
</span></span><span class="line"><span class="cl"><span class="n">ç™½åå•</span><span class="err">ï¼ˆ</span><span class="n">ç™»å½•é¡µé¢</span><span class="err">ï¼‰</span><span class="n">åˆ¤æ–­</span>
</span></span><span class="line"><span class="cl"><span class="n">ä»sessionä¸­è·å–ä¿¡æ¯åˆ¤æ–­ç™»å½•</span>
</span></span><span class="line"><span class="cl"><span class="n">ç™»é™†æˆåŠŸå°è£…ç”¨æˆ·ä¿¡æ¯è‡³request</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/post/python/order_trading_platform/1732583177967-d3c9f1f3-2401-4c56-b006-3f5f12d5cac7.png"
	
	
	
	loading="lazy"
	
	
></p>
<ul>
<li>èœå•é¡µé¢ä¼˜åŒ–</li>
</ul>
<p>layout.html æ¯ç‰ˆ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="p">{</span><span class="o">%</span> <span class="n">load</span> <span class="n">static</span> <span class="o">%</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="o">%</span> <span class="n">load</span> <span class="n">menu</span> <span class="o">%</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="err">!</span><span class="n">DOCTYPE</span> <span class="n">html</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">html</span> <span class="n">lang</span><span class="o">=</span><span class="s2">&#34;en&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">head</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">meta</span> <span class="n">charset</span><span class="o">=</span><span class="s2">&#34;UTF-8&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">title</span><span class="o">&gt;</span><span class="n">Title</span><span class="o">&lt;/</span><span class="n">title</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">link</span> <span class="n">rel</span><span class="o">=</span><span class="s2">&#34;stylesheet&#34;</span> <span class="n">href</span><span class="o">=</span><span class="s2">&#34;{</span><span class="si">% s</span><span class="s2">tatic &#39;/plugins/bootstrap/css/bootstrap.min.css&#39; %}&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">link</span> <span class="n">rel</span><span class="o">=</span><span class="s2">&#34;stylesheet&#34;</span> <span class="n">href</span><span class="o">=</span><span class="s2">&#34;{</span><span class="si">% s</span><span class="s2">tatic &#39;/plugins/font-awesome/css/font-awesome.min.css&#39; %}&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">link</span> <span class="n">rel</span><span class="o">=</span><span class="s2">&#34;stylesheet&#34;</span> <span class="n">href</span><span class="o">=</span><span class="s2">&#34;{</span><span class="si">% s</span><span class="s2">tatic &#39;/css/commons.css&#39; %}&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">link</span> <span class="n">rel</span><span class="o">=</span><span class="s2">&#34;stylesheet&#34;</span> <span class="n">href</span><span class="o">=</span><span class="s2">&#34;{</span><span class="si">% s</span><span class="s2">tatic &#39;/css/menu.css&#39; %}&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">link</span> <span class="n">rel</span><span class="o">=</span><span class="s2">&#34;stylesheet&#34;</span> <span class="n">href</span><span class="o">=</span><span class="s2">&#34;{</span><span class="si">% s</span><span class="s2">tatic &#39;/css/nav.css&#39; %}&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">link</span> <span class="n">rel</span><span class="o">=</span><span class="s2">&#34;stylesheet&#34;</span> <span class="n">href</span><span class="o">=</span><span class="s2">&#34;{</span><span class="si">% s</span><span class="s2">tatic &#39;css/search-group.css&#39; %}&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span><span class="o">%</span> <span class="n">block</span> <span class="n">css</span> <span class="o">%</span><span class="p">}{</span><span class="o">%</span> <span class="n">endblock</span> <span class="o">%</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="n">head</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">body</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&#34;pg-header&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&#34;nav&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&#34;logo-area left&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s2">&#34;{</span><span class="si">% u</span><span class="s2">rl &#39;home&#39; %}&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="o">&lt;</span><span class="n">span</span> <span class="n">style</span><span class="o">=</span><span class="s2">&#34;font-size: 18px;&#34;</span><span class="o">&gt;</span><span class="n">MYçš„ç®¡ç†å¹³å°</span><span class="o">&lt;/</span><span class="n">span</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&#34;right-menu right clearfix&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&#34;user-info right&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s2">&#34;#&#34;</span> <span class="n">class</span><span class="o">=</span><span class="s2">&#34;avatar&#34;</span> <span class="n">style</span><span class="o">=</span><span class="s2">&#34;text-decoration: none;&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="o">&lt;</span><span class="n">span</span> <span class="n">style</span><span class="o">=</span><span class="s2">&#34;color: white;margin-right: 5px;&#34;</span><span class="o">&gt;</span><span class="p">{{</span> <span class="n">request</span><span class="o">.</span><span class="n">my_user</span><span class="o">.</span><span class="n">name</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">span</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="o">&lt;</span><span class="n">img</span> <span class="n">class</span><span class="o">=</span><span class="s2">&#34;img-circle&#34;</span> <span class="n">style</span><span class="o">=</span><span class="s2">&#34;width: 35px;height: 35px;&#34;</span> <span class="n">src</span><span class="o">=</span><span class="s2">&#34;{</span><span class="si">% s</span><span class="s2">tatic &#39;images/default.png&#39; %}&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&#34;more-info&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s2">&#34;{</span><span class="si">% u</span><span class="s2">rl &#39;logout&#39; %}&#34;</span> <span class="n">class</span><span class="o">=</span><span class="s2">&#34;more-item&#34;</span><span class="o">&gt;</span><span class="n">æ³¨é”€</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&#34;pg-body&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&#34;left-menu&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&#34;menu-body&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span><span class="o">%</span> <span class="n">my_menu</span> <span class="n">request</span> <span class="o">%</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&#34;right-body&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="n">ol</span> <span class="n">class</span><span class="o">=</span><span class="s2">&#34;breadcrumb&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span><span class="o">%</span> <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">request</span><span class="o">.</span><span class="n">my_user</span><span class="o">.</span><span class="n">text_list</span> <span class="o">%</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="o">&lt;</span><span class="n">li</span><span class="o">&gt;&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s2">&#34;#&#34;</span><span class="o">&gt;</span><span class="p">{{</span> <span class="n">text</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;&lt;/</span><span class="n">li</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span><span class="o">%</span> <span class="n">endfor</span> <span class="o">%</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;/</span><span class="n">ol</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="n">div</span> <span class="n">style</span><span class="o">=</span><span class="s2">&#34;padding: 20px&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span><span class="o">%</span> <span class="n">block</span> <span class="n">content</span> <span class="o">%</span><span class="p">}{</span><span class="o">%</span> <span class="n">endblock</span> <span class="o">%</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">script</span> <span class="n">src</span><span class="o">=</span><span class="s2">&#34;{</span><span class="si">% s</span><span class="s2">tatic &#39;js/JQuery3.6.0.js&#39; %}&#34;</span><span class="o">&gt;&lt;/</span><span class="n">script</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">script</span> <span class="n">src</span><span class="o">=</span><span class="s2">&#34;{</span><span class="si">% s</span><span class="s2">tatic &#39;plugins/bootstrap/js/bootstrap.min.js&#39; %}&#34;</span><span class="o">&gt;&lt;/</span><span class="n">script</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">script</span> <span class="n">src</span><span class="o">=</span><span class="s2">&#34;{</span><span class="si">% s</span><span class="s2">tatic &#39;js/menu.js&#39; %}&#34;</span><span class="o">&gt;&lt;/</span><span class="n">script</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="o">%</span> <span class="n">block</span> <span class="n">js</span> <span class="o">%</span><span class="p">}{</span><span class="o">%</span> <span class="n">endblock</span> <span class="o">%</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="n">body</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="n">html</span><span class="o">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>home.html</p>
<blockquote>
<p>åªéœ€ç»§æ‰¿layout.htmlå¹¶æ‹“å±•å³å¯</p></blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="p">{</span><span class="o">%</span> <span class="n">extends</span> <span class="s1">&#39;layout.html&#39;</span> <span class="o">%</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="o">%</span> <span class="n">block</span> <span class="n">content</span> <span class="o">%</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">h3</span><span class="o">&gt;</span><span class="n">æ¬¢è¿</span><span class="o">&lt;/</span><span class="n">h3</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="o">%</span> <span class="n">endblock</span> <span class="o">%</span><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>åŠ¨æ€èœå•</li>
</ul>
<p><img src="/post/python/order_trading_platform/1732598117149-f4ddfbba-a2d3-48e7-af1d-4f0f0453756d.png"
	
	
	
	loading="lazy"
	
	
></p>
<ul>
<li>é¡¶éƒ¨å¯¼èˆªï¼ˆæ³¨é”€ï¼‰</li>
</ul>
<p><img src="/post/python/order_trading_platform/1732598564449-30c0f304-0cac-4e20-83ca-27421423c926.png"
	
	
	
	loading="lazy"
	
	
></p>
<ul>
<li>æƒé™æ ¡éªŒ</li>
</ul>
<p><img src="/post/python/order_trading_platform/1732694957748-4f79bd97-c777-4c4e-b154-f56c7a30aa15.png"
	
	
	
	loading="lazy"
	
	
></p>
<ul>
<li>é¡¶éƒ¨å¯¼èˆªæ ä¸å…³è”èœå•é€‰ä¸­æ ·å¼</li>
</ul>
<p><img src="/post/python/order_trading_platform/1732695541151-0b5c3516-7df2-411b-9539-26e85b61cda7.png"
	
	
	
	loading="lazy"
	
	
></p>
<p><img src="/post/python/order_trading_platform/1732695642676-d757fb34-e278-4b92-9314-dd73eeed9874.png"
	
	
	
	loading="lazy"
	
	
></p>
<h4 id="æŒ‰é’®æ˜¾ç¤ºæƒé™">æŒ‰é’®æ˜¾ç¤ºæƒé™
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">check_permission</span><span class="p">:</span><span class="n">æœ‰æ— æƒé™</span>
</span></span><span class="line"><span class="cl"><span class="n">has_permission</span><span class="p">:</span><span class="n">ç”¨äºæ§åˆ¶é¡µé¢çš„æ˜¾ç¤º</span><span class="err">ï¼Œ</span><span class="n">æœ‰å¯¹åº”æƒé™åˆ™å±•ç¤ºé¡µé¢</span>
</span></span><span class="line"><span class="cl"><span class="n">å…¶ä»–æ–¹æ³•</span><span class="p">:</span><span class="n">æ ¹æ®ä¼ å…¥çš„urlçš„nameä¸å‚æ•°åå‘ç”Ÿæˆurl</span>
</span></span><span class="line"><span class="cl"><span class="n">ç¼–è¾‘å¤„éœ€è¦å¤„ç†è·³è½¬æ—¶çš„å‚æ•°æºå¸¦é—®é¢˜</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">django.http</span> <span class="kn">import</span> <span class="n">QueryDict</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">django.template</span> <span class="kn">import</span> <span class="n">Library</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">django.conf</span> <span class="kn">import</span> <span class="n">settings</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">reverse</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">django.utils.safestring</span> <span class="kn">import</span> <span class="n">mark_safe</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">register</span> <span class="o">=</span> <span class="n">Library</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">check_permission</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># print(request, name, args, kwargs)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># &lt;WSGIRequest: GET &#39;/customer/list/&#39;&gt; customer_add () {}</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 1.è·å–å½“å‰ç™»å½•ç”¨æˆ·è§’è‰²</span>
</span></span><span class="line"><span class="cl">    <span class="n">role</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">my_user</span><span class="o">.</span><span class="n">role</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># 2.æ ¹æ®è§’è‰²è·å–æƒé™å­—å…¸</span>
</span></span><span class="line"><span class="cl">    <span class="n">permission_dict</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">MY_PERMISSION</span><span class="p">[</span><span class="n">role</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 3.åˆ¤æ–­æƒé™</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">permission_dict</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">settings</span><span class="o">.</span><span class="n">MY_PPERMISSION_PUBLIC</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@register.simple_tag</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">add_permission</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 3.1æ— æƒé™ï¼Œè¿”å›ç©º</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="ow">not</span> <span class="n">check_permission</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># 3.2æœ‰æƒé™ï¼Œé€šè¿‡nameåå‘ç”ŸæˆURL</span>
</span></span><span class="line"><span class="cl">    <span class="n">url</span> <span class="o">=</span> <span class="n">reverse</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="n">kwargs</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">tpl</span> <span class="o">=</span> <span class="s2">&#34;&#34;&#34;&lt;a href=&#34;</span><span class="si">{}</span><span class="s2">&#34; class=&#34;btn btn-success&#34;&gt;
</span></span></span><span class="line"><span class="cl"><span class="s2">        &lt;span class=&#34;glyphicon glyphicon-plus-sign&#34;&gt;&lt;/span&gt;æ–°å»º
</span></span></span><span class="line"><span class="cl"><span class="s2">    &lt;/a&gt;&#34;&#34;&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">mark_safe</span><span class="p">(</span><span class="n">tpl</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@register.simple_tag</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">edit_permission</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 3.1æ— æƒé™ï¼Œè¿”å›ç©º</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="ow">not</span> <span class="n">check_permission</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># 3.2æœ‰æƒé™ï¼Œé€šè¿‡nameåå‘ç”ŸæˆURL</span>
</span></span><span class="line"><span class="cl">    <span class="n">url</span> <span class="o">=</span> <span class="n">reverse</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="n">kwargs</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># æ ¹æ®å½“å‰ç”¨æˆ·è¯·æ±‚è·å–GETå‚æ•°</span>
</span></span><span class="line"><span class="cl">    <span class="n">param</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">urlencode</span><span class="p">()</span>  <span class="c1"># page=9&amp;xx=12</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">param</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">new_query_dict</span> <span class="o">=</span> <span class="n">QueryDict</span><span class="p">(</span><span class="n">mutable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">new_query_dict</span><span class="p">[</span><span class="s1">&#39;_filter&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">param</span>
</span></span><span class="line"><span class="cl">        <span class="n">filter_string</span> <span class="o">=</span> <span class="n">new_query_dict</span><span class="o">.</span><span class="n">urlencode</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">tpl</span> <span class="o">=</span> <span class="s2">&#34;&#34;&#34;&lt;a href=&#34;</span><span class="si">{}</span><span class="s2">?</span><span class="si">{}</span><span class="s2">&#34; class=&#34;btn btn-primary btn-xs&#34;&gt;ç¼–è¾‘&lt;/a&gt;&#34;&#34;&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">filter_string</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">mark_safe</span><span class="p">(</span><span class="n">tpl</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">tpl</span> <span class="o">=</span> <span class="s2">&#34;&#34;&#34;&lt;a href=&#34;</span><span class="si">{}</span><span class="s2">&#34; class=&#34;btn btn-primary btn-xs&#34;&gt;ç¼–è¾‘&lt;/a&gt;&#34;&#34;&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">mark_safe</span><span class="p">(</span><span class="n">tpl</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@register.simple_tag</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">delete_permission</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 3.1æ— æƒé™ï¼Œè¿”å›ç©º</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="ow">not</span> <span class="n">check_permission</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># 3.2æœ‰æƒé™ï¼Œé€šè¿‡nameåå‘ç”ŸæˆURL</span>
</span></span><span class="line"><span class="cl">    <span class="n">pk</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pk&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">tpl</span> <span class="o">=</span> <span class="s2">&#34;&#34;&#34;&lt;a cid=&#34;</span><span class="si">{}</span><span class="s2">&#34; class=&#34;btn btn-danger btn-xs btn-delete&#34;&#34;&gt;åˆ é™¤&lt;/a&gt;&#34;&#34;&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pk</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">mark_safe</span><span class="p">(</span><span class="n">tpl</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@register.simple_tag</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">delete_url_permission</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 3.1æ— æƒé™ï¼Œè¿”å›ç©º</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="ow">not</span> <span class="n">check_permission</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">url</span> <span class="o">=</span> <span class="n">reverse</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="n">kwargs</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">tpl</span> <span class="o">=</span> <span class="s2">&#34;&#34;&#34;&lt;a href=&#34;</span><span class="si">{}</span><span class="s2">&#34; class=&#34;btn btn-danger btn-xs btn-delete&#34;&gt;åˆ é™¤&lt;/a&gt;&#34;&#34;&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">mark_safe</span><span class="p">(</span><span class="n">tpl</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@register.filter</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">has_permission</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">others</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">name_list</span> <span class="o">=</span> <span class="n">others</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">name_list</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">check_permission</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kc">False</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="çº§åˆ«ç®¡ç†">çº§åˆ«ç®¡ç†
</h3><p><img src="/post/python/order_trading_platform/1732700979200-7e6e5546-7dee-4532-bffa-ff9f314e549f.png"
	
	
	
	loading="lazy"
	
	
></p>
<h4 id="çº§åˆ«åˆ—è¡¨">çº§åˆ«åˆ—è¡¨
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">å¦‚æœç”¨æˆ·æ²¡æœ‰å¯¹åº”æƒé™å°±ä¸è¦æ˜¾ç¤ºæŒ‰é’®</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/post/python/order_trading_platform/1732701720064-3a58477a-81ee-41b7-8449-593d4665076a.png"
	
	
	
	loading="lazy"
	
	
></p>
<h4 id="æ–°å¢çº§åˆ«">æ–°å¢çº§åˆ«
</h4><p><img src="/post/python/order_trading_platform/1732708539130-2b8bfdc2-487c-4d32-8f9e-8e5440e05d2c.png"
	
	
	
	loading="lazy"
	
	
></p>
<h4 id="ç¼–è¾‘çº§åˆ«">ç¼–è¾‘çº§åˆ«
</h4><p><img src="/post/python/order_trading_platform/1732708762614-b6b7596c-1305-428e-82b3-5e979cb5c4a6.png"
	
	
	
	loading="lazy"
	
	
></p>
<h4 id="åˆ é™¤çº§åˆ«">åˆ é™¤çº§åˆ«
</h4><p><img src="/post/python/order_trading_platform/1732709150253-189c3fac-8b69-4f92-889a-a3312cf450b2.png"
	
	
	
	loading="lazy"
	
	
></p>
<h3 id="å®¢æˆ·ç®¡ç†">å®¢æˆ·ç®¡ç†
</h3><p><img src="/post/python/order_trading_platform/1732709272761-5737ab89-656d-499f-8141-2793e6cb4862.png"
	
	
	
	loading="lazy"
	
	
></p>
<h4 id="å®¢æˆ·åˆ—è¡¨">å®¢æˆ·åˆ—è¡¨
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">è¯»å–å®¢æˆ·åˆ—è¡¨é¡µé¢å±•ç¤º</span>
</span></span><span class="line"><span class="cl"><span class="n">é—®é¢˜</span><span class="err">ï¼š</span> <span class="n">å¦‚æœå…³è”çš„çº§åˆ«è¢«åˆ é™¤è¯¥æ€ä¹ˆå¤„ç†</span><span class="err">ï¼Ÿ</span>
</span></span><span class="line"><span class="cl">	<span class="mf">1.</span><span class="n">åˆ é™¤çº§åˆ«æ—¶åˆ¤æ–­æ˜¯å¦æœ‰ä¸‹å±å®¢æˆ·</span><span class="err">ï¼Œ</span><span class="n">æœ‰åˆ™ä¸å…è®¸åˆ é™¤</span>
</span></span><span class="line"><span class="cl">	<span class="mf">2.</span><span class="n">è‡ªåŠ¨å°†çº§åˆ«è®¾ä¸ºæŸä¸ªçº§åˆ«</span>
</span></span><span class="line"><span class="cl">	<span class="mf">3.</span><span class="n">ä¸åšä»»ä½•å¤„ç†</span><span class="err">ï¼Œ</span><span class="n">åç»­å®¢æˆ·æŸ¥è¯¢æ ¡éªŒlevel_active</span><span class="o">=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="n">æ¨¡æ¿çš„æ—¶é—´æ ¼å¼</span>
</span></span><span class="line"><span class="cl"><span class="n">çº§åˆ«å¤„æ˜¾ç¤ºå¯¹è±¡è€Œélevel</span><span class="o">.</span><span class="n">title</span>
</span></span><span class="line"><span class="cl">	<span class="mf">1.</span><span class="n">ä¸»åŠ¨è¿è¡¨æŸ¥è¯¢</span>
</span></span><span class="line"><span class="cl">	<span class="mf">2.</span><span class="n">modelsä¸­é‡å†™__str__æ–¹æ³•æŒ‡å®šè¾“å‡º</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è§†å›¾å‡½æ•°</p>
<p><img src="/post/python/order_trading_platform/1732709842539-afbc14bf-f6bd-4dae-9dd7-cdd0cfa26063.png"
	
	
	
	loading="lazy"
	
	
></p>
<p>æ¨¡æ¿</p>
<p><img src="/post/python/order_trading_platform/1732710156474-b8061e66-cbe8-4ef2-8f27-cc11bde7e842.png"
	
	
	
	loading="lazy"
	
	
></p>
<p><img src="/post/python/order_trading_platform/1732710607268-8e661743-6b94-4bd9-bfbb-4f9d5a458a45.png"
	
	
	
	loading="lazy"
	
	
></p>
<h4 id="æ–°å»ºå®¢æˆ·">æ–°å»ºå®¢æˆ·
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">æ–°å¢form2</span><span class="o">.</span><span class="n">htmlæ¨¡æ¿</span><span class="err">ï¼Œ</span><span class="n">ä¸€è¡Œå¡«å†™ä¸¤ä¸ªå­—æ®µ</span><span class="err">ï¼ˆ</span><span class="n">æ …æ æ ·å¼</span><span class="err">ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="n">æ–°å¢é‡å¤å¯†ç å­—æ®µ</span>
</span></span><span class="line"><span class="cl"><span class="n">å±•ç¤ºçº§åˆ«æ¡ä»¶ç­›é€‰</span><span class="err">ï¼ˆ</span><span class="n">active</span><span class="o">=</span><span class="mi">1</span><span class="err">ï¼‰</span>
</span></span><span class="line"><span class="cl">	<span class="mf">1.</span><span class="n">modelsä¸­limit_choice_to</span>
</span></span><span class="line"><span class="cl">	<span class="mf">2.</span><span class="n">è‡ªå®šä¹‰choiceså’Œqueryset</span>
</span></span><span class="line"><span class="cl"><span class="n">å±•ç¤ºçº§åˆ«ç®¡ç†</span><span class="o">-</span><span class="n">é¡µé¢æ’ä»¶</span><span class="err">ï¼ˆ</span><span class="n">select</span> <span class="o">-&gt;</span> <span class="n">radio</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="mf">1.</span><span class="n">å±€éƒ¨å»é™¤bootstrapæ ·å¼</span>
</span></span><span class="line"><span class="cl">	<span class="mf">2.</span><span class="n">ä¿®æ”¹ä¸‹æ‹‰æ¡†ä¸ºradioæ¡†</span>
</span></span><span class="line"><span class="cl"><span class="n">æäº¤ä¿å­˜</span>
</span></span><span class="line"><span class="cl">	<span class="mf">1.</span><span class="n">modelsè¡¨å•éªŒè¯</span><span class="err">ï¼Œ</span><span class="n">æ­£åˆ™</span>
</span></span><span class="line"><span class="cl">	<span class="mf">2.</span><span class="n">è‡ªå®šä¹‰é’©å­</span><span class="err">ï¼Œ</span><span class="n">ä¿è¯å¯†ç ä¸€ç›´</span>
</span></span><span class="line"><span class="cl">	<span class="mf">3.</span><span class="n">modelsæ·»åŠ validators</span>
</span></span><span class="line"><span class="cl">	<span class="mf">4.</span><span class="n">ä¿å­˜</span><span class="err">ï¼ˆ</span><span class="n">æ‰‹åŠ¨æ·»åŠ creatorå­—æ®µ</span><span class="err">ï¼‰</span>
</span></span><span class="line"><span class="cl">	<span class="mf">5.</span><span class="n">è·³è½¬å›é¡µé¢</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/post/python/order_trading_platform/1732710963113-314dc788-1681-43e2-9691-c4a183b4f5d9.png"
	
	
	
	loading="lazy"
	
	
></p>
<h4 id="ç¼–è¾‘å®¢æˆ·">ç¼–è¾‘å®¢æˆ·
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">å’Œæ·»åŠ çš„é¡µé¢ä¸åŒ</span><span class="err">ï¼Œ</span><span class="n">æ–°å»ºä¸€ä¸ªform</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/post/python/order_trading_platform/1732711225774-04e3868a-9b09-4708-aaf3-52854942af3d.png"
	
	
	
	loading="lazy"
	
	
></p>
<h4 id="é‡ç½®å¯†ç ">é‡ç½®å¯†ç 
</h4><p><img src="/post/python/order_trading_platform/1732711342983-96fffb37-2bfa-4a82-9f27-951a787cc325.png"
	
	
	
	loading="lazy"
	
	
></p>
<h4 id="åˆ é™¤å®¢æˆ·å¯¹è¯æ¡†å’Œajax">åˆ é™¤å®¢æˆ·ï¼ˆå¯¹è¯æ¡†å’Œajaxï¼‰
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">æ¨¡æ€å¯¹è¯æ¡†çš„è§¦å‘æ–¹å¼</span>
</span></span><span class="line"><span class="cl">	<span class="mf">1.</span><span class="n">data</span><span class="o">-</span><span class="n">targetå±æ€§</span>
</span></span><span class="line"><span class="cl">	<span class="mf">2.</span><span class="n">ç»‘å®šç‚¹å‡»å‡½æ•°</span>
</span></span><span class="line"><span class="cl">	<span class="mf">3.</span><span class="n">ä¸€é”®ç»‘å®š</span>
</span></span><span class="line"><span class="cl"><span class="n">åˆ é™¤é€»è¾‘å®ç°</span>
</span></span><span class="line"><span class="cl"><span class="n">åˆ é™¤æˆåŠŸåé¡µé¢å¤„ç†</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/post/python/order_trading_platform/1732711493928-3f4e65ca-4047-407d-84b2-5231701ab74f.png"
	
	
	
	loading="lazy"
	
	
></p>
<h4 id="äº¤æ˜“è®°å½•åˆ—è¡¨">äº¤æ˜“è®°å½•åˆ—è¡¨
</h4><p>è§†å›¾å‡½æ•°</p>
<p><img src="/post/python/order_trading_platform/1732712848306-c24732ba-3439-4ea0-b420-d480c5ca046a.png"
	
	
	
	loading="lazy"
	
	
></p>
<p>æ¨¡æ¿</p>
<p>å……å€¼æ‰£æ¬¾æ·»åŠ é¢œè‰²</p>
<p><img src="/post/python/order_trading_platform/1732713412511-d3341d19-c1d6-409a-96ac-a5a82e8411ed.png"
	
	
	
	loading="lazy"
	
	
></p>
<p><img src="/post/python/order_trading_platform/1732713612510-d8e3a230-7f2d-489a-9f70-fd4e2b088751.png"
	
	
	
	loading="lazy"
	
	
></p>
<h4 id="å……å€¼å’Œæ‰£æ¬¾å¯¹è¯æ¡†">å……å€¼å’Œæ‰£æ¬¾ï¼ˆå¯¹è¯æ¡†ï¼‰
</h4><p>æ¨¡æ¿</p>
<h4 id=""><img src="/post/python/order_trading_platform/1732714253476-a85ee918-3e85-4bc0-9420-fb090b70999e.png"
	
	
	
	loading="lazy"
	
	
>
</h4><p>è§†å›¾å‡½æ•°</p>
<p><img src="/post/python/order_trading_platform/1732714421549-44c80ea4-589a-4a96-ad9d-da9030ba1ddd.png"
	
	
	
	loading="lazy"
	
	
></p>
<h3 id="ä»·æ ¼ç­–ç•¥">ä»·æ ¼ç­–ç•¥
</h3><p><img src="/post/python/order_trading_platform/1732714728946-9c197fdf-ae64-4434-ba7b-09a3ef0dc039.png"
	
	
	
	loading="lazy"
	
	
></p>
<h4 id="ä»·æ ¼ç­–ç•¥åˆ—è¡¨">ä»·æ ¼ç­–ç•¥åˆ—è¡¨
</h4><p><img src="/post/python/order_trading_platform/1732717257949-47129a3d-c95d-40fb-b862-0417156dd829.png"
	
	
	
	loading="lazy"
	
	
></p>
<h4 id="æ–°å»ºä»·æ ¼ç­–ç•¥">æ–°å»ºä»·æ ¼ç­–ç•¥
</h4><p><img src="/post/python/order_trading_platform/1732717308086-c7ff3823-ce95-4f3a-9a53-22d7198b86e5.png"
	
	
	
	loading="lazy"
	
	
></p>
<h4 id="ç¼–è¾‘ä»·æ ¼ç­–ç•¥">ç¼–è¾‘ä»·æ ¼ç­–ç•¥
</h4><p><img src="/post/python/order_trading_platform/1732717332909-5f7038ac-971f-4617-a7f6-cd389653e85b.png"
	
	
	
	loading="lazy"
	
	
></p>
<h4 id="åˆ é™¤ä»·æ ¼ç­–ç•¥">åˆ é™¤ä»·æ ¼ç­–ç•¥
</h4><p><img src="/post/python/order_trading_platform/1732717354155-23522bb7-dd9a-4e67-ad94-246b54868123.png"
	
	
	
	loading="lazy"
	
	
></p>
<h3 id="è®¢å•ç®¡ç†ç”¨æˆ·">è®¢å•ç®¡ç†ï¼ˆç”¨æˆ·ï¼‰
</h3><ul>
<li>æˆ‘çš„è®¢å•åˆ—è¡¨</li>
<li>ä¸‹å•
<ul>
<li>è¾“å…¥ï¼šè§†é¢‘åœ°å€ã€æ•°é‡ï¼ˆæç¤ºä»·æ ¼ç­–ç•¥ï¼‰</li>
<li>æ•°æ®åº“æ“ä½œï¼ˆäº‹åŠ¡ + é”ï¼‰
<ul>
<li>åˆ›å»ºè®¢å•è®°å½•</li>
<li>åˆ›å»ºäº¤æ˜“è®°å½•</li>
<li>æ‰£æ¬¾</li>
</ul>
</li>
<li>å†™å…¥redisé˜Ÿåˆ—ï¼ˆç­‰å¾…æ‰§è¡Œï¼‰</li>
</ul>
</li>
<li>æ’¤é”€è®¢å•ï¼ˆå¾…æ‰§è¡Œï¼‰
<ul>
<li>æ•°æ®åº“æ“ä½œ
<ul>
<li>æ›´æ–°è®¢å•çŠ¶æ€</li>
<li>ç”Ÿæˆäº¤æ˜“è®°å½•</li>
<li>å½’è¿˜æ‰£æ¬¾</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><img src="/post/python/order_trading_platform/1732717529916-4ea32a05-7e7e-4c35-9eb6-9721c26572bb.png"
	
	
	
	loading="lazy"
	
	
></p>
<h4 id="æˆ‘çš„è®¢å•åˆ—è¡¨">æˆ‘çš„è®¢å•åˆ—è¡¨
</h4><p><img src="/post/python/order_trading_platform/1732718252013-ebb91e8a-6f34-497c-865f-c6d0715ae7bf.png"
	
	
	
	loading="lazy"
	
	
></p>
<p>message</p>
<h4 id="æ–°å»ºè®¢å•">æ–°å»ºè®¢å•
</h4><p><img src="/post/python/order_trading_platform/1732718673191-5cf5603c-69fe-477c-9d2f-283a4b6d1237.png"
	
	
	
	loading="lazy"
	
	
></p>
<p><img src="/post/python/order_trading_platform/1732718836457-70e387e0-141e-4175-8e55-25a7363eb655.png"
	
	
	
	loading="lazy"
	
	
></p>
<h4 id="æ’¤é”€è®¢å•">æ’¤é”€è®¢å•
</h4><p><img src="/post/python/order_trading_platform/1732721178721-88384401-a19f-446d-9661-d957c2b2c46d.png"
	
	
	
	loading="lazy"
	
	
></p>
<h3 id="æˆ‘çš„äº¤æ˜“è®°å½•">æˆ‘çš„äº¤æ˜“è®°å½•
</h3><p><img src="/post/python/order_trading_platform/1732721310752-098e3751-9820-412c-a3ef-8a2e8a511fed.png"
	
	
	
	loading="lazy"
	
	
></p>
<h4 id="å®¢æˆ·">å®¢æˆ·
</h4><p><img src="/post/python/order_trading_platform/1732721442476-eef3795d-2b96-4160-8345-2d9c8ba09d53.png"
	
	
	
	loading="lazy"
	
	
></p>
<p><img src="/post/python/order_trading_platform/1732721550932-6d819b16-6653-4b80-b620-9b6d40c1af7d.png"
	
	
	
	loading="lazy"
	
	
></p>
<h4 id="ç®¡ç†å‘˜">ç®¡ç†å‘˜
</h4><p><img src="/post/python/order_trading_platform/1732721666199-d74a8162-588c-4425-85b4-32366ad50ab1.png"
	
	
	
	loading="lazy"
	
	
></p>
<p>æ¨¡æ¿ä¸å®¢æˆ·æ— å¼‚</p>
<h3 id="worker">Worker
</h3><p><img src="/post/python/order_trading_platform/1732721732393-6b533304-9dd0-41fa-b251-04ab2f9b2bcb.png"
	
	
	
	loading="lazy"
	
	
></p>
<p>æ‰§è¡Œworkerå»æ‰§è¡Œè®¢å•çš„æ‰§è¡Œã€‚</p>
</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/django/">Django</a>
        
            <a href="/tags/python/">Python</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">ç›¸å…³æ–‡ç« </h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="">
    <a href="/p/drf/">
        
        

        <div class="article-details">
            <h2 class="article-title">Drf</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/django/">
        
        

        <div class="article-details">
            <h2 class="article-title">Django</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    <script src="https://utteranc.es/client.js" 
        repo="yn0t1me/blog-commnet"
        issue-term="pathname"
        
        label="utterances"
        
        crossorigin="anonymous"
        async
        >
</script>

<style>
    .utterances {
        max-width: unset;
    }
</style>

<script>
    let utterancesLoaded = false;

    function setUtterancesTheme(theme) {
        let utterances = document.querySelector('.utterances iframe');
        if (utterances) {
            utterances.contentWindow.postMessage(
                {
                    type: 'set-theme',
                    theme: `github-${theme}`
                },
                'https://utteranc.es'
            );
        }
    }

    addEventListener('message', event => {
        if (event.origin !== 'https://utteranc.es') return;

        
        utterancesLoaded = true;
        setUtterancesTheme(document.documentElement.dataset.scheme)
    });

    window.addEventListener('onColorSchemeChange', (e) => {
        if (!utterancesLoaded) return;
        setUtterancesTheme(e.detail)
    })
</script>


    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2020 - 
        
        2025 yn0t1me
    </section>
    
    <section class="powerby">
        ä½¿ç”¨ <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> æ„å»º <br />
        ä¸»é¢˜ <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.30.0">Stack</a></b> ç”± <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a> è®¾è®¡
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
